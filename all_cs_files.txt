using System;
using System.Collections.Generic;
using System.Configuration;
using System.Data;
using System.Linq;
using System.Threading.Tasks;
using System.Windows;

namespace UP
{
    /// <summary>
    /// Логика взаимодействия для App.xaml
    /// </summary>
    public partial class App : Application
    {
    }
}
﻿using System.Windows;
using System.Windows.Controls;
using UP.Pages;
using UP.Services;

namespace UP
{
    public partial class MainWindow : Window
    {
        public static MainWindow mainWindow;

        public MainWindow()
        {
            InitializeComponent();
            mainWindow = this;

            // Настройка API
            AppData.ApiService = new ApiService("https://localhost:7197/api/");

            OpenPages(new LogInPage());
        }

        public void OpenPages(Page page)
        {
            frame.Navigate(page);

            if (page is FrameworkElement frameworkElement)
            {
                frameworkElement.HorizontalAlignment = HorizontalAlignment.Stretch;
                frameworkElement.VerticalAlignment = VerticalAlignment.Stretch;
            }
        }
    }
}﻿using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Linq;
using System.Threading.Tasks;
using System.Windows;
using UP.Models;
using UP.Pages;
using UP.Services;

namespace UP
{
    public static class AppData
    {
        public static ApiService ApiService { get; set; } = new ApiService();
        public static UserData CurrentUser { get; set; }

        public static ObservableCollection<string> Products { get; set; } = new ObservableCollection<string>();
        public static ObservableCollection<Receipts.DailyMenu> WeeklyMenu { get; set; } = new ObservableCollection<Receipts.DailyMenu>();
        public static ObservableCollection<string> ShoppingList { get; set; } = new ObservableCollection<string>();
        public static ObservableCollection<RecipeDetailsPage.RecipeData> Favorites { get; set; } = new ObservableCollection<RecipeDetailsPage.RecipeData>();
        public static ObservableCollection<RecipeDto> AllRecipes { get; set; } = new ObservableCollection<RecipeDto>();

        public static async void InitializeAfterLogin(UserData user)
        {
            CurrentUser = user;
            await LoadInitialData();
        }

        public static async Task LoadInitialData()
        {
            try
            {
                await LoadRecipes();
                await LoadFavorites();
                await LoadCurrentMenu();
                await LoadShoppingList();
            }
            catch (Exception ex)
            {
                MessageBox.Show($"Ошибка загрузки данных: {ex.Message}", "Ошибка");
            }
        }

        public static async Task LoadRecipes()
        {
            try
            {
                var recipes = await ApiService.GetRecipesAsync();
                AllRecipes.Clear();

                foreach (var recipe in recipes)
                {
                    AllRecipes.Add(recipe);
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine($"Error loading recipes: {ex.Message}");
            }
        }

        public static async Task LoadFavorites()
        {
            try
            {
                var favorites = await ApiService.GetFavoritesAsync();
                Favorites.Clear();

                foreach (var recipe in favorites)
                {
                    Favorites.Add(ConvertToRecipeData(recipe));
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine($"Error loading favorites: {ex.Message}");
            }
        }

        public static async Task LoadCurrentMenu()
        {
            try
            {
                var menu = await ApiService.GetCurrentMenuAsync();
                WeeklyMenu.Clear();

                if (menu != null && menu.Days != null)
                {
                    foreach (var day in menu.Days)
                    {
                        foreach (var meal in day.Meals)
                        {
                            WeeklyMenu.Add(new Receipts.DailyMenu
                            {
                                Day = day.Date,
                                Meal = meal.RecipeTitle,
                                Description = $"Калории: {meal.Calories} | Время: {meal.PrepTime} мин",
                                RecipeId = meal.RecipeId
                            });
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine($"Error loading menu: {ex.Message}");
            }
        }

        public static async Task LoadShoppingList()
        {
            try
            {
                var shoppingList = await ApiService.GetCurrentShoppingListAsync();
                ShoppingList.Clear();

                if (shoppingList != null && shoppingList.Items != null)
                {
                    foreach (var item in shoppingList.Items)
                    {
                        if (!item.IsPurchased)
                        {
                            ShoppingList.Add($"{item.IngredientName} - {item.Quantity} {item.Unit}");
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine($"Error loading shopping list: {ex.Message}");
            }
        }

        public static async Task<bool> AddToFavorites(RecipeDetailsPage.RecipeData recipe)
        {
            try
            {
                var apiRecipe = AllRecipes.FirstOrDefault(r => r.Title == recipe.Title);
                if (apiRecipe != null)
                {
                    return await ApiService.ToggleFavoriteAsync(apiRecipe.Id);
                }
                return false;
            }
            catch (Exception ex)
            {
                Console.WriteLine($"Error adding to favorites: {ex.Message}");
                return false;
            }
        }

        public static async Task<bool> RemoveFromFavorites(RecipeDetailsPage.RecipeData recipe)
        {
            try
            {
                var apiRecipe = AllRecipes.FirstOrDefault(r => r.Title == recipe.Title);
                if (apiRecipe != null)
                {
                    return await ApiService.ToggleFavoriteAsync(apiRecipe.Id);
                }
                return false;
            }
            catch (Exception ex)
            {
                Console.WriteLine($"Error removing from favorites: {ex.Message}");
                return false;
            }
        }

        private static RecipeDetailsPage.RecipeData ConvertToRecipeData(RecipeDto recipe)
        {
            return new RecipeDetailsPage.RecipeData
            {
                Title = recipe.Title,
                Description = recipe.Description,
                ImageUrl = recipe.ImageUrl,
                Ingredients = recipe.Ingredients?.ConvertAll(i => $"{i.Name} - {i.Quantity} {i.Unit}") ?? new List<string>(),
                Steps = recipe.Instructions ?? new List<string>()
            };
        }

        public static void Logout()
        {
            CurrentUser = null;
            ApiService.ClearToken();

            Products.Clear();
            WeeklyMenu.Clear();
            ShoppingList.Clear();
            Favorites.Clear();
            AllRecipes.Clear();
        }
    }
}﻿using System.Collections.Generic;
using System.Collections.ObjectModel;

namespace UP.Models
{
    public class LoginRequest
    {
        public string Username { get; set; }
        public string Password { get; set; }
    }

    public class RegisterRequest
    {
        public string Username { get; set; }
        public string Email { get; set; }
        public string Password { get; set; }
        public List<string> Allergies { get; set; } = new List<string>();
    }

    public class AuthResponse
    {
        public bool Success { get; set; }
        public string Message { get; set; }
        public UserData Data { get; set; }
    }

    public class UserData
    {
        public int Id { get; set; }
        public string Username { get; set; }
        public string Email { get; set; }
        public string FullName { get; set; }
        public string Token { get; set; }
    }

    public class RecipeDto
    {
        public int Id { get; set; }
        public string Title { get; set; }
        public string Description { get; set; }
        public string ImageUrl { get; set; }
        public int PrepTime { get; set; }
        public int CookTime { get; set; }
        public decimal Calories { get; set; }
        public List<IngredientDto> Ingredients { get; set; } = new List<IngredientDto>();
        public List<string> Instructions { get; set; } = new List<string>();
        public string CuisineType { get; set; }
        public string Difficulty { get; set; }
    }

    public class IngredientDto
    {
        public int Id { get; set; }
        public string Name { get; set; }
        public decimal Quantity { get; set; }
        public string Unit { get; set; }
        public string Category { get; set; }
    }


    public class MenuDto
    {
        public int Id { get; set; }
        public string Name { get; set; }
        public decimal TotalCalories { get; set; }
        public List<MenuDayDto> Days { get; set; } = new List<MenuDayDto>();
    }

    public class MenuDayDto
    {
        public string Date { get; set; }
        public List<MenuMealDto> Meals { get; set; } = new List<MenuMealDto>();
    }

    public class MenuMealDto
    {
        public int Id { get; set; }
        public int RecipeId { get; set; }
        public string RecipeTitle { get; set; }
        public string MealType { get; set; }
        public decimal Calories { get; set; }
        public int PrepTime { get; set; }
        public string ImageUrl { get; set; }
    }

    public class ShoppingListDto
    {
        public int Id { get; set; }
        public string Name { get; set; }
        public bool IsCompleted { get; set; }
        public List<ShoppingListItemDto> Items { get; set; } = new List<ShoppingListItemDto>();
    }

    public class ShoppingListItemDto
    {
        public int Id { get; set; }
        public string IngredientName { get; set; }
        public decimal Quantity { get; set; }
        public string Unit { get; set; }
        public string Category { get; set; }
        public bool IsPurchased { get; set; }
    }
}// <autogenerated />
using System;
using System.Reflection;
[assembly: global::System.Runtime.Versioning.TargetFrameworkAttribute(".NETFramework,Version=v4.7.2", FrameworkDisplayName = ".NET Framework 4.7.2")]
﻿#pragma checksum "..\..\App.xaml" "{8829d00f-11b8-4213-878b-770e8597ac16}" "59C6E7EBEF07C7464503EDEE481DBC704FD9C67A67A4798EB6A2D4C5EECF618C"
//------------------------------------------------------------------------------
// <auto-generated>
//     Этот код создан программой.
//     Исполняемая версия:4.0.30319.42000
//
//     Изменения в этом файле могут привести к неправильной работе и будут потеряны в случае
//     повторной генерации кода.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Diagnostics;
using System.Windows;
using System.Windows.Automation;
using System.Windows.Controls;
using System.Windows.Controls.Primitives;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Ink;
using System.Windows.Input;
using System.Windows.Markup;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Media.Effects;
using System.Windows.Media.Imaging;
using System.Windows.Media.Media3D;
using System.Windows.Media.TextFormatting;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Windows.Shell;
using UP;


namespace UP {
    
    
    /// <summary>
    /// App
    /// </summary>
    public partial class App : System.Windows.Application {
        
        /// <summary>
        /// InitializeComponent
        /// </summary>
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        public void InitializeComponent() {
            
            #line 5 "..\..\App.xaml"
            this.StartupUri = new System.Uri("MainWindow.xaml", System.UriKind.Relative);
            
            #line default
            #line hidden
        }
        
        /// <summary>
        /// Application Entry Point.
        /// </summary>
        [System.STAThreadAttribute()]
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        public static void Main() {
            UP.App app = new UP.App();
            app.InitializeComponent();
            app.Run();
        }
    }
}

﻿#pragma checksum "..\..\App.xaml" "{8829d00f-11b8-4213-878b-770e8597ac16}" "59C6E7EBEF07C7464503EDEE481DBC704FD9C67A67A4798EB6A2D4C5EECF618C"
//------------------------------------------------------------------------------
// <auto-generated>
//     Этот код создан программой.
//     Исполняемая версия:4.0.30319.42000
//
//     Изменения в этом файле могут привести к неправильной работе и будут потеряны в случае
//     повторной генерации кода.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Diagnostics;
using System.Windows;
using System.Windows.Automation;
using System.Windows.Controls;
using System.Windows.Controls.Primitives;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Ink;
using System.Windows.Input;
using System.Windows.Markup;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Media.Effects;
using System.Windows.Media.Imaging;
using System.Windows.Media.Media3D;
using System.Windows.Media.TextFormatting;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Windows.Shell;
using UP;


namespace UP {
    
    
    /// <summary>
    /// App
    /// </summary>
    public partial class App : System.Windows.Application {
        
        /// <summary>
        /// InitializeComponent
        /// </summary>
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        public void InitializeComponent() {
            
            #line 5 "..\..\App.xaml"
            this.StartupUri = new System.Uri("MainWindow.xaml", System.UriKind.Relative);
            
            #line default
            #line hidden
        }
        
        /// <summary>
        /// Application Entry Point.
        /// </summary>
        [System.STAThreadAttribute()]
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        public static void Main() {
            UP.App app = new UP.App();
            app.InitializeComponent();
            app.Run();
        }
    }
}

﻿#pragma checksum "..\..\MainWindow.xaml" "{8829d00f-11b8-4213-878b-770e8597ac16}" "57B0F1AB726BA964D4384C2E3267436C082E830B693F52B35C3BD256355F725A"
//------------------------------------------------------------------------------
// <auto-generated>
//     Этот код создан программой.
//     Исполняемая версия:4.0.30319.42000
//
//     Изменения в этом файле могут привести к неправильной работе и будут потеряны в случае
//     повторной генерации кода.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Diagnostics;
using System.Windows;
using System.Windows.Automation;
using System.Windows.Controls;
using System.Windows.Controls.Primitives;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Ink;
using System.Windows.Input;
using System.Windows.Markup;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Media.Effects;
using System.Windows.Media.Imaging;
using System.Windows.Media.Media3D;
using System.Windows.Media.TextFormatting;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Windows.Shell;
using UP;


namespace UP {
    
    
    /// <summary>
    /// MainWindow
    /// </summary>
    public partial class MainWindow : System.Windows.Window, System.Windows.Markup.IComponentConnector {
        
        
        #line 11 "..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.Frame frame;
        
        #line default
        #line hidden
        
        private bool _contentLoaded;
        
        /// <summary>
        /// InitializeComponent
        /// </summary>
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        public void InitializeComponent() {
            if (_contentLoaded) {
                return;
            }
            _contentLoaded = true;
            System.Uri resourceLocater = new System.Uri("/UP;component/mainwindow.xaml", System.UriKind.Relative);
            
            #line 1 "..\..\MainWindow.xaml"
            System.Windows.Application.LoadComponent(this, resourceLocater);
            
            #line default
            #line hidden
        }
        
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        [System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Never)]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Design", "CA1033:InterfaceMethodsShouldBeCallableByChildTypes")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Maintainability", "CA1502:AvoidExcessiveComplexity")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1800:DoNotCastUnnecessarily")]
        void System.Windows.Markup.IComponentConnector.Connect(int connectionId, object target) {
            switch (connectionId)
            {
            case 1:
            this.frame = ((System.Windows.Controls.Frame)(target));
            return;
            }
            this._contentLoaded = true;
        }
    }
}

﻿#pragma checksum "..\..\MainWindow.xaml" "{8829d00f-11b8-4213-878b-770e8597ac16}" "57B0F1AB726BA964D4384C2E3267436C082E830B693F52B35C3BD256355F725A"
//------------------------------------------------------------------------------
// <auto-generated>
//     Этот код создан программой.
//     Исполняемая версия:4.0.30319.42000
//
//     Изменения в этом файле могут привести к неправильной работе и будут потеряны в случае
//     повторной генерации кода.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Diagnostics;
using System.Windows;
using System.Windows.Automation;
using System.Windows.Controls;
using System.Windows.Controls.Primitives;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Ink;
using System.Windows.Input;
using System.Windows.Markup;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Media.Effects;
using System.Windows.Media.Imaging;
using System.Windows.Media.Media3D;
using System.Windows.Media.TextFormatting;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Windows.Shell;
using UP;


namespace UP {
    
    
    /// <summary>
    /// MainWindow
    /// </summary>
    public partial class MainWindow : System.Windows.Window, System.Windows.Markup.IComponentConnector {
        
        
        #line 11 "..\..\MainWindow.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.Frame frame;
        
        #line default
        #line hidden
        
        private bool _contentLoaded;
        
        /// <summary>
        /// InitializeComponent
        /// </summary>
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        public void InitializeComponent() {
            if (_contentLoaded) {
                return;
            }
            _contentLoaded = true;
            System.Uri resourceLocater = new System.Uri("/UP;component/mainwindow.xaml", System.UriKind.Relative);
            
            #line 1 "..\..\MainWindow.xaml"
            System.Windows.Application.LoadComponent(this, resourceLocater);
            
            #line default
            #line hidden
        }
        
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        [System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Never)]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Design", "CA1033:InterfaceMethodsShouldBeCallableByChildTypes")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Maintainability", "CA1502:AvoidExcessiveComplexity")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1800:DoNotCastUnnecessarily")]
        void System.Windows.Markup.IComponentConnector.Connect(int connectionId, object target) {
            switch (connectionId)
            {
            case 1:
            this.frame = ((System.Windows.Controls.Frame)(target));
            return;
            }
            this._contentLoaded = true;
        }
    }
}

﻿//------------------------------------------------------------------------------
// <auto-generated>
//     Этот код создан программой.
//     Исполняемая версия:4.0.30319.42000
//
//     Изменения в этом файле могут привести к неправильной работе и будут потеряны в случае
//     повторной генерации кода.
// </auto-generated>
//------------------------------------------------------------------------------

[assembly: System.Windows.Resources.AssemblyAssociatedContentFileAttribute("images/scary.jpg")]


﻿//------------------------------------------------------------------------------
// <auto-generated>
//     Этот код создан программой.
//     Исполняемая версия:4.0.30319.42000
//
//     Изменения в этом файле могут привести к неправильной работе и будут потеряны в случае
//     повторной генерации кода.
// </auto-generated>
//------------------------------------------------------------------------------

[assembly: System.Windows.Resources.AssemblyAssociatedContentFileAttribute("images/scary.jpg")]


﻿#pragma checksum "..\..\..\Pages\FavoritesPage.xaml" "{8829d00f-11b8-4213-878b-770e8597ac16}" "B57B879EB1A4D945BAFEE9F657E4FAF9BCEA2AC7A9CB49B7F5867266A931BE9B"
//------------------------------------------------------------------------------
// <auto-generated>
//     Этот код создан программой.
//     Исполняемая версия:4.0.30319.42000
//
//     Изменения в этом файле могут привести к неправильной работе и будут потеряны в случае
//     повторной генерации кода.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Diagnostics;
using System.Windows;
using System.Windows.Automation;
using System.Windows.Controls;
using System.Windows.Controls.Primitives;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Ink;
using System.Windows.Input;
using System.Windows.Markup;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Media.Effects;
using System.Windows.Media.Imaging;
using System.Windows.Media.Media3D;
using System.Windows.Media.TextFormatting;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Windows.Shell;


namespace UP.Pages {
    
    
    /// <summary>
    /// FavoritesPage
    /// </summary>
    public partial class FavoritesPage : System.Windows.Controls.Page, System.Windows.Markup.IComponentConnector, System.Windows.Markup.IStyleConnector {
        
        
        #line 53 "..\..\..\Pages\FavoritesPage.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.ItemsControl FavoritesList;
        
        #line default
        #line hidden
        
        private bool _contentLoaded;
        
        /// <summary>
        /// InitializeComponent
        /// </summary>
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        public void InitializeComponent() {
            if (_contentLoaded) {
                return;
            }
            _contentLoaded = true;
            System.Uri resourceLocater = new System.Uri("/UP;component/pages/favoritespage.xaml", System.UriKind.Relative);
            
            #line 1 "..\..\..\Pages\FavoritesPage.xaml"
            System.Windows.Application.LoadComponent(this, resourceLocater);
            
            #line default
            #line hidden
        }
        
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        [System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Never)]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Design", "CA1033:InterfaceMethodsShouldBeCallableByChildTypes")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Maintainability", "CA1502:AvoidExcessiveComplexity")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1800:DoNotCastUnnecessarily")]
        void System.Windows.Markup.IComponentConnector.Connect(int connectionId, object target) {
            switch (connectionId)
            {
            case 1:
            
            #line 42 "..\..\..\Pages\FavoritesPage.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.BackButton_Click);
            
            #line default
            #line hidden
            return;
            case 2:
            this.FavoritesList = ((System.Windows.Controls.ItemsControl)(target));
            return;
            }
            this._contentLoaded = true;
        }
        
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        [System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Never)]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Design", "CA1033:InterfaceMethodsShouldBeCallableByChildTypes")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1800:DoNotCastUnnecessarily")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Maintainability", "CA1502:AvoidExcessiveComplexity")]
        void System.Windows.Markup.IStyleConnector.Connect(int connectionId, object target) {
            switch (connectionId)
            {
            case 3:
            
            #line 95 "..\..\..\Pages\FavoritesPage.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.OpenRecipe_Click);
            
            #line default
            #line hidden
            break;
            case 4:
            
            #line 104 "..\..\..\Pages\FavoritesPage.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.RemoveRecipe_Click);
            
            #line default
            #line hidden
            break;
            }
        }
    }
}

﻿#pragma checksum "..\..\..\Pages\FavoritesPage.xaml" "{8829d00f-11b8-4213-878b-770e8597ac16}" "B57B879EB1A4D945BAFEE9F657E4FAF9BCEA2AC7A9CB49B7F5867266A931BE9B"
//------------------------------------------------------------------------------
// <auto-generated>
//     Этот код создан программой.
//     Исполняемая версия:4.0.30319.42000
//
//     Изменения в этом файле могут привести к неправильной работе и будут потеряны в случае
//     повторной генерации кода.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Diagnostics;
using System.Windows;
using System.Windows.Automation;
using System.Windows.Controls;
using System.Windows.Controls.Primitives;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Ink;
using System.Windows.Input;
using System.Windows.Markup;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Media.Effects;
using System.Windows.Media.Imaging;
using System.Windows.Media.Media3D;
using System.Windows.Media.TextFormatting;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Windows.Shell;


namespace UP.Pages {
    
    
    /// <summary>
    /// FavoritesPage
    /// </summary>
    public partial class FavoritesPage : System.Windows.Controls.Page, System.Windows.Markup.IComponentConnector, System.Windows.Markup.IStyleConnector {
        
        
        #line 53 "..\..\..\Pages\FavoritesPage.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.ItemsControl FavoritesList;
        
        #line default
        #line hidden
        
        private bool _contentLoaded;
        
        /// <summary>
        /// InitializeComponent
        /// </summary>
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        public void InitializeComponent() {
            if (_contentLoaded) {
                return;
            }
            _contentLoaded = true;
            System.Uri resourceLocater = new System.Uri("/UP;component/pages/favoritespage.xaml", System.UriKind.Relative);
            
            #line 1 "..\..\..\Pages\FavoritesPage.xaml"
            System.Windows.Application.LoadComponent(this, resourceLocater);
            
            #line default
            #line hidden
        }
        
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        [System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Never)]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Design", "CA1033:InterfaceMethodsShouldBeCallableByChildTypes")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Maintainability", "CA1502:AvoidExcessiveComplexity")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1800:DoNotCastUnnecessarily")]
        void System.Windows.Markup.IComponentConnector.Connect(int connectionId, object target) {
            switch (connectionId)
            {
            case 1:
            
            #line 42 "..\..\..\Pages\FavoritesPage.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.BackButton_Click);
            
            #line default
            #line hidden
            return;
            case 2:
            this.FavoritesList = ((System.Windows.Controls.ItemsControl)(target));
            return;
            }
            this._contentLoaded = true;
        }
        
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        [System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Never)]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Design", "CA1033:InterfaceMethodsShouldBeCallableByChildTypes")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1800:DoNotCastUnnecessarily")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Maintainability", "CA1502:AvoidExcessiveComplexity")]
        void System.Windows.Markup.IStyleConnector.Connect(int connectionId, object target) {
            switch (connectionId)
            {
            case 3:
            
            #line 95 "..\..\..\Pages\FavoritesPage.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.OpenRecipe_Click);
            
            #line default
            #line hidden
            break;
            case 4:
            
            #line 104 "..\..\..\Pages\FavoritesPage.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.RemoveRecipe_Click);
            
            #line default
            #line hidden
            break;
            }
        }
    }
}

﻿#pragma checksum "..\..\..\Pages\LogInPage.xaml" "{8829d00f-11b8-4213-878b-770e8597ac16}" "3E4A75613654FD92FAA439A52A2C6C0B23B2591804F2E62AA66DFBC5001D5E78"
//------------------------------------------------------------------------------
// <auto-generated>
//     Этот код создан программой.
//     Исполняемая версия:4.0.30319.42000
//
//     Изменения в этом файле могут привести к неправильной работе и будут потеряны в случае
//     повторной генерации кода.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Diagnostics;
using System.Windows;
using System.Windows.Automation;
using System.Windows.Controls;
using System.Windows.Controls.Primitives;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Ink;
using System.Windows.Input;
using System.Windows.Markup;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Media.Effects;
using System.Windows.Media.Imaging;
using System.Windows.Media.Media3D;
using System.Windows.Media.TextFormatting;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Windows.Shell;


namespace UP.Pages {
    
    
    /// <summary>
    /// LogInPage
    /// </summary>
    public partial class LogInPage : System.Windows.Controls.Page, System.Windows.Markup.IComponentConnector {
        
        
        #line 68 "..\..\..\Pages\LogInPage.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.TextBox SecretCodeBox;
        
        #line default
        #line hidden
        
        
        #line 90 "..\..\..\Pages\LogInPage.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.TextBox UsernameTextBox;
        
        #line default
        #line hidden
        
        
        #line 101 "..\..\..\Pages\LogInPage.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.PasswordBox PasswordBox;
        
        #line default
        #line hidden
        
        
        #line 122 "..\..\..\Pages\LogInPage.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.Button LoginButton;
        
        #line default
        #line hidden
        
        private bool _contentLoaded;
        
        /// <summary>
        /// InitializeComponent
        /// </summary>
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        public void InitializeComponent() {
            if (_contentLoaded) {
                return;
            }
            _contentLoaded = true;
            System.Uri resourceLocater = new System.Uri("/UP;component/pages/loginpage.xaml", System.UriKind.Relative);
            
            #line 1 "..\..\..\Pages\LogInPage.xaml"
            System.Windows.Application.LoadComponent(this, resourceLocater);
            
            #line default
            #line hidden
        }
        
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        [System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Never)]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Design", "CA1033:InterfaceMethodsShouldBeCallableByChildTypes")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Maintainability", "CA1502:AvoidExcessiveComplexity")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1800:DoNotCastUnnecessarily")]
        void System.Windows.Markup.IComponentConnector.Connect(int connectionId, object target) {
            switch (connectionId)
            {
            case 1:
            this.SecretCodeBox = ((System.Windows.Controls.TextBox)(target));
            
            #line 76 "..\..\..\Pages\LogInPage.xaml"
            this.SecretCodeBox.KeyDown += new System.Windows.Input.KeyEventHandler(this.SecretCodeBox_KeyDown);
            
            #line default
            #line hidden
            return;
            case 2:
            this.UsernameTextBox = ((System.Windows.Controls.TextBox)(target));
            return;
            case 3:
            this.PasswordBox = ((System.Windows.Controls.PasswordBox)(target));
            return;
            case 4:
            this.LoginButton = ((System.Windows.Controls.Button)(target));
            
            #line 126 "..\..\..\Pages\LogInPage.xaml"
            this.LoginButton.Click += new System.Windows.RoutedEventHandler(this.LoginButton_Click);
            
            #line default
            #line hidden
            return;
            case 5:
            
            #line 135 "..\..\..\Pages\LogInPage.xaml"
            ((System.Windows.Controls.TextBlock)(target)).MouseLeftButtonDown += new System.Windows.Input.MouseButtonEventHandler(this.RegisterText_MouseLeftButtonDown);
            
            #line default
            #line hidden
            return;
            }
            this._contentLoaded = true;
        }
    }
}

﻿#pragma checksum "..\..\..\Pages\LogInPage.xaml" "{8829d00f-11b8-4213-878b-770e8597ac16}" "3E4A75613654FD92FAA439A52A2C6C0B23B2591804F2E62AA66DFBC5001D5E78"
//------------------------------------------------------------------------------
// <auto-generated>
//     Этот код создан программой.
//     Исполняемая версия:4.0.30319.42000
//
//     Изменения в этом файле могут привести к неправильной работе и будут потеряны в случае
//     повторной генерации кода.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Diagnostics;
using System.Windows;
using System.Windows.Automation;
using System.Windows.Controls;
using System.Windows.Controls.Primitives;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Ink;
using System.Windows.Input;
using System.Windows.Markup;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Media.Effects;
using System.Windows.Media.Imaging;
using System.Windows.Media.Media3D;
using System.Windows.Media.TextFormatting;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Windows.Shell;


namespace UP.Pages {
    
    
    /// <summary>
    /// LogInPage
    /// </summary>
    public partial class LogInPage : System.Windows.Controls.Page, System.Windows.Markup.IComponentConnector {
        
        
        #line 68 "..\..\..\Pages\LogInPage.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.TextBox SecretCodeBox;
        
        #line default
        #line hidden
        
        
        #line 90 "..\..\..\Pages\LogInPage.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.TextBox UsernameTextBox;
        
        #line default
        #line hidden
        
        
        #line 101 "..\..\..\Pages\LogInPage.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.PasswordBox PasswordBox;
        
        #line default
        #line hidden
        
        
        #line 122 "..\..\..\Pages\LogInPage.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.Button LoginButton;
        
        #line default
        #line hidden
        
        private bool _contentLoaded;
        
        /// <summary>
        /// InitializeComponent
        /// </summary>
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        public void InitializeComponent() {
            if (_contentLoaded) {
                return;
            }
            _contentLoaded = true;
            System.Uri resourceLocater = new System.Uri("/UP;component/pages/loginpage.xaml", System.UriKind.Relative);
            
            #line 1 "..\..\..\Pages\LogInPage.xaml"
            System.Windows.Application.LoadComponent(this, resourceLocater);
            
            #line default
            #line hidden
        }
        
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        [System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Never)]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Design", "CA1033:InterfaceMethodsShouldBeCallableByChildTypes")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Maintainability", "CA1502:AvoidExcessiveComplexity")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1800:DoNotCastUnnecessarily")]
        void System.Windows.Markup.IComponentConnector.Connect(int connectionId, object target) {
            switch (connectionId)
            {
            case 1:
            this.SecretCodeBox = ((System.Windows.Controls.TextBox)(target));
            
            #line 76 "..\..\..\Pages\LogInPage.xaml"
            this.SecretCodeBox.KeyDown += new System.Windows.Input.KeyEventHandler(this.SecretCodeBox_KeyDown);
            
            #line default
            #line hidden
            return;
            case 2:
            this.UsernameTextBox = ((System.Windows.Controls.TextBox)(target));
            return;
            case 3:
            this.PasswordBox = ((System.Windows.Controls.PasswordBox)(target));
            return;
            case 4:
            this.LoginButton = ((System.Windows.Controls.Button)(target));
            
            #line 126 "..\..\..\Pages\LogInPage.xaml"
            this.LoginButton.Click += new System.Windows.RoutedEventHandler(this.LoginButton_Click);
            
            #line default
            #line hidden
            return;
            case 5:
            
            #line 135 "..\..\..\Pages\LogInPage.xaml"
            ((System.Windows.Controls.TextBlock)(target)).MouseLeftButtonDown += new System.Windows.Input.MouseButtonEventHandler(this.RegisterText_MouseLeftButtonDown);
            
            #line default
            #line hidden
            return;
            }
            this._contentLoaded = true;
        }
    }
}

﻿#pragma checksum "..\..\..\Pages\ReceiptDetailPage.xaml" "{8829d00f-11b8-4213-878b-770e8597ac16}" "46A0E84F936389FF6C4E7C0A4CC8D21A99228C1847E6C9D0D906BE17A25C24CE"
//------------------------------------------------------------------------------
// <auto-generated>
//     Этот код создан программой.
//     Исполняемая версия:4.0.30319.42000
//
//     Изменения в этом файле могут привести к неправильной работе и будут потеряны в случае
//     повторной генерации кода.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Diagnostics;
using System.Windows;
using System.Windows.Automation;
using System.Windows.Controls;
using System.Windows.Controls.Primitives;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Ink;
using System.Windows.Input;
using System.Windows.Markup;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Media.Effects;
using System.Windows.Media.Imaging;
using System.Windows.Media.Media3D;
using System.Windows.Media.TextFormatting;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Windows.Shell;


namespace UP.Pages {
    
    
    /// <summary>
    /// RecipeDetailsPage
    /// </summary>
    public partial class RecipeDetailsPage : System.Windows.Controls.Page, System.Windows.Markup.IComponentConnector {
        
        
        #line 67 "..\..\..\Pages\ReceiptDetailPage.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.TextBlock RecipeTitleText;
        
        #line default
        #line hidden
        
        
        #line 73 "..\..\..\Pages\ReceiptDetailPage.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.Image RecipeImage;
        
        #line default
        #line hidden
        
        
        #line 78 "..\..\..\Pages\ReceiptDetailPage.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.TextBlock RecipeDescriptionText;
        
        #line default
        #line hidden
        
        
        #line 95 "..\..\..\Pages\ReceiptDetailPage.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.ItemsControl IngredientsList;
        
        #line default
        #line hidden
        
        
        #line 113 "..\..\..\Pages\ReceiptDetailPage.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.ItemsControl StepsList;
        
        #line default
        #line hidden
        
        private bool _contentLoaded;
        
        /// <summary>
        /// InitializeComponent
        /// </summary>
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        public void InitializeComponent() {
            if (_contentLoaded) {
                return;
            }
            _contentLoaded = true;
            System.Uri resourceLocater = new System.Uri("/UP;component/pages/receiptdetailpage.xaml", System.UriKind.Relative);
            
            #line 1 "..\..\..\Pages\ReceiptDetailPage.xaml"
            System.Windows.Application.LoadComponent(this, resourceLocater);
            
            #line default
            #line hidden
        }
        
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        [System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Never)]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Design", "CA1033:InterfaceMethodsShouldBeCallableByChildTypes")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Maintainability", "CA1502:AvoidExcessiveComplexity")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1800:DoNotCastUnnecessarily")]
        void System.Windows.Markup.IComponentConnector.Connect(int connectionId, object target) {
            switch (connectionId)
            {
            case 1:
            
            #line 51 "..\..\..\Pages\ReceiptDetailPage.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.BackButton_Click);
            
            #line default
            #line hidden
            return;
            case 2:
            this.RecipeTitleText = ((System.Windows.Controls.TextBlock)(target));
            return;
            case 3:
            this.RecipeImage = ((System.Windows.Controls.Image)(target));
            return;
            case 4:
            this.RecipeDescriptionText = ((System.Windows.Controls.TextBlock)(target));
            return;
            case 5:
            this.IngredientsList = ((System.Windows.Controls.ItemsControl)(target));
            return;
            case 6:
            this.StepsList = ((System.Windows.Controls.ItemsControl)(target));
            return;
            case 7:
            
            #line 138 "..\..\..\Pages\ReceiptDetailPage.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.StartTimer_Click);
            
            #line default
            #line hidden
            return;
            case 8:
            
            #line 139 "..\..\..\Pages\ReceiptDetailPage.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.AddToShoppingList_Click);
            
            #line default
            #line hidden
            return;
            case 9:
            
            #line 140 "..\..\..\Pages\ReceiptDetailPage.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.AddToFavorites_Click);
            
            #line default
            #line hidden
            return;
            }
            this._contentLoaded = true;
        }
    }
}

﻿#pragma checksum "..\..\..\Pages\ReceiptDetailPage.xaml" "{8829d00f-11b8-4213-878b-770e8597ac16}" "46A0E84F936389FF6C4E7C0A4CC8D21A99228C1847E6C9D0D906BE17A25C24CE"
//------------------------------------------------------------------------------
// <auto-generated>
//     Этот код создан программой.
//     Исполняемая версия:4.0.30319.42000
//
//     Изменения в этом файле могут привести к неправильной работе и будут потеряны в случае
//     повторной генерации кода.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Diagnostics;
using System.Windows;
using System.Windows.Automation;
using System.Windows.Controls;
using System.Windows.Controls.Primitives;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Ink;
using System.Windows.Input;
using System.Windows.Markup;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Media.Effects;
using System.Windows.Media.Imaging;
using System.Windows.Media.Media3D;
using System.Windows.Media.TextFormatting;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Windows.Shell;


namespace UP.Pages {
    
    
    /// <summary>
    /// RecipeDetailsPage
    /// </summary>
    public partial class RecipeDetailsPage : System.Windows.Controls.Page, System.Windows.Markup.IComponentConnector {
        
        
        #line 67 "..\..\..\Pages\ReceiptDetailPage.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.TextBlock RecipeTitleText;
        
        #line default
        #line hidden
        
        
        #line 73 "..\..\..\Pages\ReceiptDetailPage.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.Image RecipeImage;
        
        #line default
        #line hidden
        
        
        #line 78 "..\..\..\Pages\ReceiptDetailPage.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.TextBlock RecipeDescriptionText;
        
        #line default
        #line hidden
        
        
        #line 95 "..\..\..\Pages\ReceiptDetailPage.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.ItemsControl IngredientsList;
        
        #line default
        #line hidden
        
        
        #line 113 "..\..\..\Pages\ReceiptDetailPage.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.ItemsControl StepsList;
        
        #line default
        #line hidden
        
        private bool _contentLoaded;
        
        /// <summary>
        /// InitializeComponent
        /// </summary>
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        public void InitializeComponent() {
            if (_contentLoaded) {
                return;
            }
            _contentLoaded = true;
            System.Uri resourceLocater = new System.Uri("/UP;component/pages/receiptdetailpage.xaml", System.UriKind.Relative);
            
            #line 1 "..\..\..\Pages\ReceiptDetailPage.xaml"
            System.Windows.Application.LoadComponent(this, resourceLocater);
            
            #line default
            #line hidden
        }
        
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        [System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Never)]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Design", "CA1033:InterfaceMethodsShouldBeCallableByChildTypes")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Maintainability", "CA1502:AvoidExcessiveComplexity")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1800:DoNotCastUnnecessarily")]
        void System.Windows.Markup.IComponentConnector.Connect(int connectionId, object target) {
            switch (connectionId)
            {
            case 1:
            
            #line 51 "..\..\..\Pages\ReceiptDetailPage.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.BackButton_Click);
            
            #line default
            #line hidden
            return;
            case 2:
            this.RecipeTitleText = ((System.Windows.Controls.TextBlock)(target));
            return;
            case 3:
            this.RecipeImage = ((System.Windows.Controls.Image)(target));
            return;
            case 4:
            this.RecipeDescriptionText = ((System.Windows.Controls.TextBlock)(target));
            return;
            case 5:
            this.IngredientsList = ((System.Windows.Controls.ItemsControl)(target));
            return;
            case 6:
            this.StepsList = ((System.Windows.Controls.ItemsControl)(target));
            return;
            case 7:
            
            #line 138 "..\..\..\Pages\ReceiptDetailPage.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.StartTimer_Click);
            
            #line default
            #line hidden
            return;
            case 8:
            
            #line 139 "..\..\..\Pages\ReceiptDetailPage.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.AddToShoppingList_Click);
            
            #line default
            #line hidden
            return;
            case 9:
            
            #line 140 "..\..\..\Pages\ReceiptDetailPage.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.AddToFavorites_Click);
            
            #line default
            #line hidden
            return;
            }
            this._contentLoaded = true;
        }
    }
}

﻿#pragma checksum "..\..\..\Pages\Receipts.xaml" "{8829d00f-11b8-4213-878b-770e8597ac16}" "1D569DA5F30DCC9A77345DFD421F4833D43976A6A71BAB1188F4F29E47B9A0E3"
//------------------------------------------------------------------------------
// <auto-generated>
//     Этот код создан программой.
//     Исполняемая версия:4.0.30319.42000
//
//     Изменения в этом файле могут привести к неправильной работе и будут потеряны в случае
//     повторной генерации кода.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Diagnostics;
using System.Windows;
using System.Windows.Automation;
using System.Windows.Controls;
using System.Windows.Controls.Primitives;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Ink;
using System.Windows.Input;
using System.Windows.Markup;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Media.Effects;
using System.Windows.Media.Imaging;
using System.Windows.Media.Media3D;
using System.Windows.Media.TextFormatting;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Windows.Shell;
using UP.Pages;


namespace UP.Pages {
    
    
    /// <summary>
    /// Receipts
    /// </summary>
    public partial class Receipts : System.Windows.Controls.Page, System.Windows.Markup.IComponentConnector, System.Windows.Markup.IStyleConnector {
        
        
        #line 107 "..\..\..\Pages\Receipts.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.TextBox NewProductTextBox;
        
        #line default
        #line hidden
        
        
        #line 119 "..\..\..\Pages\Receipts.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.ListView ProductsListView;
        
        #line default
        #line hidden
        
        
        #line 157 "..\..\..\Pages\Receipts.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.CheckBox GlutenCheckBox;
        
        #line default
        #line hidden
        
        
        #line 161 "..\..\..\Pages\Receipts.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.CheckBox LactoseCheckBox;
        
        #line default
        #line hidden
        
        
        #line 165 "..\..\..\Pages\Receipts.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.CheckBox NutsCheckBox;
        
        #line default
        #line hidden
        
        
        #line 169 "..\..\..\Pages\Receipts.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.CheckBox SeafoodCheckBox;
        
        #line default
        #line hidden
        
        
        #line 176 "..\..\..\Pages\Receipts.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.TextBox OtherAllergiesTextBox;
        
        #line default
        #line hidden
        
        
        #line 194 "..\..\..\Pages\Receipts.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.ItemsControl WeeklyMenuItemsControl;
        
        #line default
        #line hidden
        
        
        #line 250 "..\..\..\Pages\Receipts.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.ItemsControl ActiveTimersItemsControl;
        
        #line default
        #line hidden
        
        
        #line 282 "..\..\..\Pages\Receipts.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.TextBlock NoTimersText;
        
        #line default
        #line hidden
        
        
        #line 305 "..\..\..\Pages\Receipts.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.ListView ShoppingListListView;
        
        #line default
        #line hidden
        
        private bool _contentLoaded;
        
        /// <summary>
        /// InitializeComponent
        /// </summary>
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        public void InitializeComponent() {
            if (_contentLoaded) {
                return;
            }
            _contentLoaded = true;
            System.Uri resourceLocater = new System.Uri("/UP;component/pages/receipts.xaml", System.UriKind.Relative);
            
            #line 1 "..\..\..\Pages\Receipts.xaml"
            System.Windows.Application.LoadComponent(this, resourceLocater);
            
            #line default
            #line hidden
        }
        
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        [System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Never)]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Design", "CA1033:InterfaceMethodsShouldBeCallableByChildTypes")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Maintainability", "CA1502:AvoidExcessiveComplexity")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1800:DoNotCastUnnecessarily")]
        void System.Windows.Markup.IComponentConnector.Connect(int connectionId, object target) {
            switch (connectionId)
            {
            case 1:
            
            #line 80 "..\..\..\Pages\Receipts.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.OpenFavorites_Click);
            
            #line default
            #line hidden
            return;
            case 2:
            this.NewProductTextBox = ((System.Windows.Controls.TextBox)(target));
            return;
            case 3:
            
            #line 117 "..\..\..\Pages\Receipts.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.AddProduct_Click);
            
            #line default
            #line hidden
            return;
            case 4:
            this.ProductsListView = ((System.Windows.Controls.ListView)(target));
            return;
            case 6:
            this.GlutenCheckBox = ((System.Windows.Controls.CheckBox)(target));
            return;
            case 7:
            this.LactoseCheckBox = ((System.Windows.Controls.CheckBox)(target));
            return;
            case 8:
            this.NutsCheckBox = ((System.Windows.Controls.CheckBox)(target));
            return;
            case 9:
            this.SeafoodCheckBox = ((System.Windows.Controls.CheckBox)(target));
            return;
            case 10:
            this.OtherAllergiesTextBox = ((System.Windows.Controls.TextBox)(target));
            
            #line 183 "..\..\..\Pages\Receipts.xaml"
            this.OtherAllergiesTextBox.TextChanged += new System.Windows.Controls.TextChangedEventHandler(this.OtherAllergiesTextBox_TextChanged);
            
            #line default
            #line hidden
            return;
            case 11:
            this.WeeklyMenuItemsControl = ((System.Windows.Controls.ItemsControl)(target));
            return;
            case 14:
            this.ActiveTimersItemsControl = ((System.Windows.Controls.ItemsControl)(target));
            return;
            case 16:
            this.NoTimersText = ((System.Windows.Controls.TextBlock)(target));
            return;
            case 17:
            this.ShoppingListListView = ((System.Windows.Controls.ListView)(target));
            return;
            case 19:
            
            #line 322 "..\..\..\Pages\Receipts.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.ExportShoppingList_Click);
            
            #line default
            #line hidden
            return;
            case 20:
            
            #line 339 "..\..\..\Pages\Receipts.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.BackButton_Click);
            
            #line default
            #line hidden
            return;
            }
            this._contentLoaded = true;
        }
        
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        [System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Never)]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Design", "CA1033:InterfaceMethodsShouldBeCallableByChildTypes")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1800:DoNotCastUnnecessarily")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Maintainability", "CA1502:AvoidExcessiveComplexity")]
        void System.Windows.Markup.IStyleConnector.Connect(int connectionId, object target) {
            switch (connectionId)
            {
            case 5:
            
            #line 140 "..\..\..\Pages\Receipts.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.RemoveProduct_Click);
            
            #line default
            #line hidden
            break;
            case 12:
            
            #line 220 "..\..\..\Pages\Receipts.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.StartTimer_Click);
            
            #line default
            #line hidden
            break;
            case 13:
            
            #line 229 "..\..\..\Pages\Receipts.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.OpenRecipe_Click);
            
            #line default
            #line hidden
            break;
            case 15:
            
            #line 275 "..\..\..\Pages\Receipts.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.StopTimer_Click);
            
            #line default
            #line hidden
            break;
            case 18:
            
            #line 314 "..\..\..\Pages\Receipts.xaml"
            ((System.Windows.Controls.CheckBox)(target)).Checked += new System.Windows.RoutedEventHandler(this.ShoppingItem_Checked);
            
            #line default
            #line hidden
            break;
            }
        }
    }
}

﻿#pragma checksum "..\..\..\Pages\Receipts.xaml" "{8829d00f-11b8-4213-878b-770e8597ac16}" "1D569DA5F30DCC9A77345DFD421F4833D43976A6A71BAB1188F4F29E47B9A0E3"
//------------------------------------------------------------------------------
// <auto-generated>
//     Этот код создан программой.
//     Исполняемая версия:4.0.30319.42000
//
//     Изменения в этом файле могут привести к неправильной работе и будут потеряны в случае
//     повторной генерации кода.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Diagnostics;
using System.Windows;
using System.Windows.Automation;
using System.Windows.Controls;
using System.Windows.Controls.Primitives;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Ink;
using System.Windows.Input;
using System.Windows.Markup;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Media.Effects;
using System.Windows.Media.Imaging;
using System.Windows.Media.Media3D;
using System.Windows.Media.TextFormatting;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Windows.Shell;
using UP.Pages;


namespace UP.Pages {
    
    
    /// <summary>
    /// Receipts
    /// </summary>
    public partial class Receipts : System.Windows.Controls.Page, System.Windows.Markup.IComponentConnector, System.Windows.Markup.IStyleConnector {
        
        
        #line 107 "..\..\..\Pages\Receipts.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.TextBox NewProductTextBox;
        
        #line default
        #line hidden
        
        
        #line 119 "..\..\..\Pages\Receipts.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.ListView ProductsListView;
        
        #line default
        #line hidden
        
        
        #line 157 "..\..\..\Pages\Receipts.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.CheckBox GlutenCheckBox;
        
        #line default
        #line hidden
        
        
        #line 161 "..\..\..\Pages\Receipts.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.CheckBox LactoseCheckBox;
        
        #line default
        #line hidden
        
        
        #line 165 "..\..\..\Pages\Receipts.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.CheckBox NutsCheckBox;
        
        #line default
        #line hidden
        
        
        #line 169 "..\..\..\Pages\Receipts.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.CheckBox SeafoodCheckBox;
        
        #line default
        #line hidden
        
        
        #line 176 "..\..\..\Pages\Receipts.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.TextBox OtherAllergiesTextBox;
        
        #line default
        #line hidden
        
        
        #line 194 "..\..\..\Pages\Receipts.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.ItemsControl WeeklyMenuItemsControl;
        
        #line default
        #line hidden
        
        
        #line 250 "..\..\..\Pages\Receipts.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.ItemsControl ActiveTimersItemsControl;
        
        #line default
        #line hidden
        
        
        #line 282 "..\..\..\Pages\Receipts.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.TextBlock NoTimersText;
        
        #line default
        #line hidden
        
        
        #line 305 "..\..\..\Pages\Receipts.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.ListView ShoppingListListView;
        
        #line default
        #line hidden
        
        private bool _contentLoaded;
        
        /// <summary>
        /// InitializeComponent
        /// </summary>
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        public void InitializeComponent() {
            if (_contentLoaded) {
                return;
            }
            _contentLoaded = true;
            System.Uri resourceLocater = new System.Uri("/UP;component/pages/receipts.xaml", System.UriKind.Relative);
            
            #line 1 "..\..\..\Pages\Receipts.xaml"
            System.Windows.Application.LoadComponent(this, resourceLocater);
            
            #line default
            #line hidden
        }
        
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        [System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Never)]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Design", "CA1033:InterfaceMethodsShouldBeCallableByChildTypes")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Maintainability", "CA1502:AvoidExcessiveComplexity")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1800:DoNotCastUnnecessarily")]
        void System.Windows.Markup.IComponentConnector.Connect(int connectionId, object target) {
            switch (connectionId)
            {
            case 1:
            
            #line 80 "..\..\..\Pages\Receipts.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.OpenFavorites_Click);
            
            #line default
            #line hidden
            return;
            case 2:
            this.NewProductTextBox = ((System.Windows.Controls.TextBox)(target));
            return;
            case 3:
            
            #line 117 "..\..\..\Pages\Receipts.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.AddProduct_Click);
            
            #line default
            #line hidden
            return;
            case 4:
            this.ProductsListView = ((System.Windows.Controls.ListView)(target));
            return;
            case 6:
            this.GlutenCheckBox = ((System.Windows.Controls.CheckBox)(target));
            return;
            case 7:
            this.LactoseCheckBox = ((System.Windows.Controls.CheckBox)(target));
            return;
            case 8:
            this.NutsCheckBox = ((System.Windows.Controls.CheckBox)(target));
            return;
            case 9:
            this.SeafoodCheckBox = ((System.Windows.Controls.CheckBox)(target));
            return;
            case 10:
            this.OtherAllergiesTextBox = ((System.Windows.Controls.TextBox)(target));
            
            #line 183 "..\..\..\Pages\Receipts.xaml"
            this.OtherAllergiesTextBox.TextChanged += new System.Windows.Controls.TextChangedEventHandler(this.OtherAllergiesTextBox_TextChanged);
            
            #line default
            #line hidden
            return;
            case 11:
            this.WeeklyMenuItemsControl = ((System.Windows.Controls.ItemsControl)(target));
            return;
            case 14:
            this.ActiveTimersItemsControl = ((System.Windows.Controls.ItemsControl)(target));
            return;
            case 16:
            this.NoTimersText = ((System.Windows.Controls.TextBlock)(target));
            return;
            case 17:
            this.ShoppingListListView = ((System.Windows.Controls.ListView)(target));
            return;
            case 19:
            
            #line 322 "..\..\..\Pages\Receipts.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.ExportShoppingList_Click);
            
            #line default
            #line hidden
            return;
            case 20:
            
            #line 339 "..\..\..\Pages\Receipts.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.BackButton_Click);
            
            #line default
            #line hidden
            return;
            }
            this._contentLoaded = true;
        }
        
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        [System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Never)]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Design", "CA1033:InterfaceMethodsShouldBeCallableByChildTypes")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1800:DoNotCastUnnecessarily")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Maintainability", "CA1502:AvoidExcessiveComplexity")]
        void System.Windows.Markup.IStyleConnector.Connect(int connectionId, object target) {
            switch (connectionId)
            {
            case 5:
            
            #line 140 "..\..\..\Pages\Receipts.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.RemoveProduct_Click);
            
            #line default
            #line hidden
            break;
            case 12:
            
            #line 220 "..\..\..\Pages\Receipts.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.StartTimer_Click);
            
            #line default
            #line hidden
            break;
            case 13:
            
            #line 229 "..\..\..\Pages\Receipts.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.OpenRecipe_Click);
            
            #line default
            #line hidden
            break;
            case 15:
            
            #line 275 "..\..\..\Pages\Receipts.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.StopTimer_Click);
            
            #line default
            #line hidden
            break;
            case 18:
            
            #line 314 "..\..\..\Pages\Receipts.xaml"
            ((System.Windows.Controls.CheckBox)(target)).Checked += new System.Windows.RoutedEventHandler(this.ShoppingItem_Checked);
            
            #line default
            #line hidden
            break;
            }
        }
    }
}

﻿#pragma checksum "..\..\..\Pages\RegIn.xaml" "{8829d00f-11b8-4213-878b-770e8597ac16}" "737DDF81BA1078259C253AB077DB5CABDB5567025C18664A3413BDCA7E8C7C45"
//------------------------------------------------------------------------------
// <auto-generated>
//     Этот код создан программой.
//     Исполняемая версия:4.0.30319.42000
//
//     Изменения в этом файле могут привести к неправильной работе и будут потеряны в случае
//     повторной генерации кода.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Diagnostics;
using System.Windows;
using System.Windows.Automation;
using System.Windows.Controls;
using System.Windows.Controls.Primitives;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Ink;
using System.Windows.Input;
using System.Windows.Markup;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Media.Effects;
using System.Windows.Media.Imaging;
using System.Windows.Media.Media3D;
using System.Windows.Media.TextFormatting;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Windows.Shell;


namespace UP.Pages {
    
    
    /// <summary>
    /// RegIn
    /// </summary>
    public partial class RegIn : System.Windows.Controls.Page, System.Windows.Markup.IComponentConnector {
        
        
        #line 87 "..\..\..\Pages\RegIn.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.TextBox UsernameTextBox;
        
        #line default
        #line hidden
        
        
        #line 98 "..\..\..\Pages\RegIn.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.TextBox EmailTextBox;
        
        #line default
        #line hidden
        
        
        #line 109 "..\..\..\Pages\RegIn.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.PasswordBox PasswordBox;
        
        #line default
        #line hidden
        
        
        #line 135 "..\..\..\Pages\RegIn.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.PasswordBox ConfirmPasswordBox;
        
        #line default
        #line hidden
        
        private bool _contentLoaded;
        
        /// <summary>
        /// InitializeComponent
        /// </summary>
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        public void InitializeComponent() {
            if (_contentLoaded) {
                return;
            }
            _contentLoaded = true;
            System.Uri resourceLocater = new System.Uri("/UP;component/pages/regin.xaml", System.UriKind.Relative);
            
            #line 1 "..\..\..\Pages\RegIn.xaml"
            System.Windows.Application.LoadComponent(this, resourceLocater);
            
            #line default
            #line hidden
        }
        
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        [System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Never)]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Design", "CA1033:InterfaceMethodsShouldBeCallableByChildTypes")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Maintainability", "CA1502:AvoidExcessiveComplexity")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1800:DoNotCastUnnecessarily")]
        void System.Windows.Markup.IComponentConnector.Connect(int connectionId, object target) {
            switch (connectionId)
            {
            case 1:
            this.UsernameTextBox = ((System.Windows.Controls.TextBox)(target));
            return;
            case 2:
            this.EmailTextBox = ((System.Windows.Controls.TextBox)(target));
            return;
            case 3:
            this.PasswordBox = ((System.Windows.Controls.PasswordBox)(target));
            return;
            case 4:
            this.ConfirmPasswordBox = ((System.Windows.Controls.PasswordBox)(target));
            return;
            case 5:
            
            #line 167 "..\..\..\Pages\RegIn.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.RegisterButton_Click);
            
            #line default
            #line hidden
            return;
            case 6:
            
            #line 174 "..\..\..\Pages\RegIn.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.BackButton_Click);
            
            #line default
            #line hidden
            return;
            case 7:
            
            #line 184 "..\..\..\Pages\RegIn.xaml"
            ((System.Windows.Controls.TextBlock)(target)).MouseLeftButtonDown += new System.Windows.Input.MouseButtonEventHandler(this.LoginText_MouseLeftButtonDown);
            
            #line default
            #line hidden
            return;
            }
            this._contentLoaded = true;
        }
    }
}

﻿#pragma checksum "..\..\..\Pages\RegIn.xaml" "{8829d00f-11b8-4213-878b-770e8597ac16}" "737DDF81BA1078259C253AB077DB5CABDB5567025C18664A3413BDCA7E8C7C45"
//------------------------------------------------------------------------------
// <auto-generated>
//     Этот код создан программой.
//     Исполняемая версия:4.0.30319.42000
//
//     Изменения в этом файле могут привести к неправильной работе и будут потеряны в случае
//     повторной генерации кода.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Diagnostics;
using System.Windows;
using System.Windows.Automation;
using System.Windows.Controls;
using System.Windows.Controls.Primitives;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Ink;
using System.Windows.Input;
using System.Windows.Markup;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Media.Effects;
using System.Windows.Media.Imaging;
using System.Windows.Media.Media3D;
using System.Windows.Media.TextFormatting;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Windows.Shell;


namespace UP.Pages {
    
    
    /// <summary>
    /// RegIn
    /// </summary>
    public partial class RegIn : System.Windows.Controls.Page, System.Windows.Markup.IComponentConnector {
        
        
        #line 87 "..\..\..\Pages\RegIn.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.TextBox UsernameTextBox;
        
        #line default
        #line hidden
        
        
        #line 98 "..\..\..\Pages\RegIn.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.TextBox EmailTextBox;
        
        #line default
        #line hidden
        
        
        #line 109 "..\..\..\Pages\RegIn.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.PasswordBox PasswordBox;
        
        #line default
        #line hidden
        
        
        #line 135 "..\..\..\Pages\RegIn.xaml"
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields")]
        internal System.Windows.Controls.PasswordBox ConfirmPasswordBox;
        
        #line default
        #line hidden
        
        private bool _contentLoaded;
        
        /// <summary>
        /// InitializeComponent
        /// </summary>
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        public void InitializeComponent() {
            if (_contentLoaded) {
                return;
            }
            _contentLoaded = true;
            System.Uri resourceLocater = new System.Uri("/UP;component/pages/regin.xaml", System.UriKind.Relative);
            
            #line 1 "..\..\..\Pages\RegIn.xaml"
            System.Windows.Application.LoadComponent(this, resourceLocater);
            
            #line default
            #line hidden
        }
        
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        [System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Never)]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Design", "CA1033:InterfaceMethodsShouldBeCallableByChildTypes")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Maintainability", "CA1502:AvoidExcessiveComplexity")]
        [System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1800:DoNotCastUnnecessarily")]
        void System.Windows.Markup.IComponentConnector.Connect(int connectionId, object target) {
            switch (connectionId)
            {
            case 1:
            this.UsernameTextBox = ((System.Windows.Controls.TextBox)(target));
            return;
            case 2:
            this.EmailTextBox = ((System.Windows.Controls.TextBox)(target));
            return;
            case 3:
            this.PasswordBox = ((System.Windows.Controls.PasswordBox)(target));
            return;
            case 4:
            this.ConfirmPasswordBox = ((System.Windows.Controls.PasswordBox)(target));
            return;
            case 5:
            
            #line 167 "..\..\..\Pages\RegIn.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.RegisterButton_Click);
            
            #line default
            #line hidden
            return;
            case 6:
            
            #line 174 "..\..\..\Pages\RegIn.xaml"
            ((System.Windows.Controls.Button)(target)).Click += new System.Windows.RoutedEventHandler(this.BackButton_Click);
            
            #line default
            #line hidden
            return;
            case 7:
            
            #line 184 "..\..\..\Pages\RegIn.xaml"
            ((System.Windows.Controls.TextBlock)(target)).MouseLeftButtonDown += new System.Windows.Input.MouseButtonEventHandler(this.LoginText_MouseLeftButtonDown);
            
            #line default
            #line hidden
            return;
            }
            this._contentLoaded = true;
        }
    }
}

﻿using System.Linq;
using System.Windows;
using System.Windows.Controls;
using UP.Services;

namespace UP.Pages
{
    public partial class FavoritesPage : Page
    {
        public FavoritesPage()
        {
            InitializeComponent();
            LoadFavorites();
        }

        private void LoadFavorites()
        {
            FavoritesList.ItemsSource = AppData.Favorites;
        }

        private void BackButton_Click(object sender, RoutedEventArgs e)
        {
            MainWindow.mainWindow.OpenPages(new Receipts());
        }

        private async void OpenRecipe_Click(object sender, RoutedEventArgs e)
        {
            if (sender is Button button && button.DataContext is RecipeDetailsPage.RecipeData recipe)
            {
                var detailsPage = new RecipeDetailsPage(
                    recipe.Title,
                    recipe.Description,
                    recipe.ImageUrl,
                    recipe.Ingredients,
                    recipe.Steps
                );

                MainWindow.mainWindow.OpenPages(detailsPage);
            }
        }

        private async void RemoveRecipe_Click(object sender, RoutedEventArgs e)
        {
            if (sender is Button button && button.DataContext is RecipeDetailsPage.RecipeData recipe)
            {
                if (MessageBox.Show($"Удалить рецепт '{recipe.Title}' из избранного?", "Подтверждение",
                                    MessageBoxButton.YesNo, MessageBoxImage.Question) == MessageBoxResult.Yes)
                {
                    var success = await AppData.RemoveFromFavorites(recipe);
                    if (success)
                    {
                        AppData.Favorites.Remove(recipe);
                        MessageBox.Show("Рецепт удален из избранного", "Успех");
                    }
                    else
                    {
                        MessageBox.Show("Не удалось удалить рецепт", "Ошибка");
                    }
                }
            }
        }

        private async void RefreshFavorites_Click(object sender, RoutedEventArgs e)
        {
            await AppData.LoadFavorites();
            LoadFavorites();
        }
    }
}﻿using System;
using System.Collections.Generic;
using System.Net.Http;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Input;
using UP.Models;
using UP.Services;

namespace UP.Pages
{
    public partial class LogInPage : Page
    {
        private string secretCode = "qweasd";

        public LogInPage()
        {
            InitializeComponent();
            Loaded += (s, e) => UsernameTextBox.Focus();
            UsernameTextBox.KeyDown += TextBox_KeyDown;
            PasswordBox.KeyDown += TextBox_KeyDown;
        }

        private async void LoginButton_Click(object sender, RoutedEventArgs e)
        {
            await AttemptLogin();
        }

        private async void TextBox_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.Key == Key.Enter)
            {
                await AttemptLogin();
            }
        }

        private async Task AttemptLogin()
        {
            string username = UsernameTextBox.Text;
            string password = PasswordBox.Password;

            if (string.IsNullOrWhiteSpace(username))
            {
                ShowMessage("Введите имя пользователя");
                UsernameTextBox.Focus();
                return;
            }

            if (string.IsNullOrWhiteSpace(password))
            {
                ShowMessage("Введите пароль");
                PasswordBox.Focus();
                return;
            }

            LoginButton.IsEnabled = false;
            LoginButton.Content = "Вход...";

            try
            {
                var user = await AppData.ApiService.LoginAsync(username, password);
                AppData.InitializeAfterLogin(user);

                ShowMessage($"Успешный вход! Добро пожаловать, {user.Username}");
                MainWindow.mainWindow.OpenPages(new Receipts());
            }
            catch (HttpRequestException httpEx)
            {
                ShowMessage($"Ошибка сети: {httpEx.Message}\n\nПроверьте:\n1. Запущен ли бекенд\n2. Блокирует ли фаервол\n3. Доступен ли localhost:7197");
            }
            catch (Exception ex)
            {
                ShowMessage($"Ошибка входа: {ex.Message}");
            }
            finally
            {
                LoginButton.IsEnabled = true;
                LoginButton.Content = "Войти";
            }
        }
        private void ShowMessage(string message)
        {
            MessageBox.Show(message, "Вход в систему",
                          MessageBoxButton.OK, MessageBoxImage.Information);
        }

        private void RegisterText_MouseLeftButtonDown(object sender, MouseButtonEventArgs e)
        {
            NavigationService?.Navigate(new RegIn());
        }

        private void SecretCodeBox_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.Key == Key.Enter)
            {
                if (SecretCodeBox.Text == secretCode)
                {
                    ShowScaryImage();
                }
                SecretCodeBox.Clear();
            }
        }

        private void ShowScaryImage()
        {
            Window scaryWindow = new Window
            {
                Height = 1080,
                Width = 1920,
                WindowState = WindowState.Maximized,
                WindowStyle = WindowStyle.None,
                Topmost = true,
                Left = 0,
                Top = 0
            };

            Image img = new Image
            {
                Source = new System.Windows.Media.Imaging.BitmapImage(new System.Uri("pack://application:,,,/Images/scary.jpg")),
                Stretch = System.Windows.Media.Stretch.UniformToFill
            };

            scaryWindow.Content = img;
            scaryWindow.Show();
        }
    }
}﻿using System;
using System.Collections.Generic;
using System.Linq;
using System.Windows;
using System.Windows.Controls;
using UP.Models;
using UP.Services;

namespace UP.Pages
{
    public partial class RecipeDetailsPage : Page
    {
        public class RecipeData
        {
            public string Title { get; set; }
            public string Description { get; set; }
            public string ImageUrl { get; set; }
            public List<string> Ingredients { get; set; }
            public List<string> Steps { get; set; }
        }

        private RecipeData _currentRecipe;

        public RecipeDetailsPage(string title, string description, string imageUrl, List<string> ingredients, List<string> steps)
        {
            InitializeComponent();

            _currentRecipe = new RecipeData
            {
                Title = title,
                Description = description,
                ImageUrl = imageUrl,
                Ingredients = ingredients,
                Steps = steps
            };

            RecipeTitleText.Text = title;
            RecipeDescriptionText.Text = description;

            if (!string.IsNullOrEmpty(imageUrl))
            {
                RecipeImage.Source = new System.Windows.Media.Imaging.BitmapImage(new Uri(imageUrl));
            }

            IngredientsList.ItemsSource = ingredients;

            var stepObjects = new List<object>();
            int i = 1;
            foreach (var step in steps)
                stepObjects.Add(new { StepNumber = i++, StepText = step });
            StepsList.ItemsSource = stepObjects;
        }

        private void BackButton_Click(object sender, RoutedEventArgs e)
        {
            MainWindow.mainWindow.OpenPages(new Receipts());
        }

        private void StartTimer_Click(object sender, RoutedEventArgs e)
        {
            var timerWindow = new TimerWindow(RecipeTitleText.Text);
            timerWindow.ShowDialog();
        }

        private void AddToShoppingList_Click(object sender, RoutedEventArgs e)
        {
            // Добавляем ингредиенты в локальный список
            foreach (var ingredient in _currentRecipe.Ingredients)
            {
                AppData.ShoppingList.Add(ingredient);
            }

            MessageBox.Show("Ингредиенты добавлены в список покупок.", "Список покупок",
                            MessageBoxButton.OK, MessageBoxImage.Information);
        }

        private async void AddToFavorites_Click(object sender, RoutedEventArgs e)
        {
            try
            {
                var success = await AppData.AddToFavorites(_currentRecipe);
                if (success)
                {
                    // Проверяем, нет ли уже в избранном
                    if (!AppData.Favorites.Any(f => f.Title == _currentRecipe.Title))
                    {
                        AppData.Favorites.Add(_currentRecipe);
                    }

                    MessageBox.Show("Рецепт добавлен в избранное!", "Избранное",
                                    MessageBoxButton.OK, MessageBoxImage.Information);
                }
                else
                {
                    MessageBox.Show("Не удалось добавить в избранное", "Ошибка",
                                    MessageBoxButton.OK, MessageBoxImage.Error);
                }
            }
            catch (Exception ex)
            {
                MessageBox.Show($"Ошибка: {ex.Message}", "Ошибка",
                                MessageBoxButton.OK, MessageBoxImage.Error);
            }
        }
    }
}﻿using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Linq;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Media;
using UP.Models;

namespace UP.Pages
{
    public partial class Receipts : Page
    {
        public class DailyMenu
        {
            public string Day { get; set; }
            public string Meal { get; set; }
            public string Description { get; set; }
            public int RecipeId { get; set; }
        }

        public class TimerItem
        {
            public string Name { get; set; }
            public string TimeLeft { get; set; }
            public System.Windows.Threading.DispatcherTimer Timer { get; set; }
            public DateTime EndTime { get; set; }
        }

        private ObservableCollection<string> _products;
        private ObservableCollection<DailyMenu> _weeklyMenu;
        private ObservableCollection<TimerItem> _activeTimers;
        private ObservableCollection<string> _shoppingList;

        public Receipts()
        {
            InitializeComponent();
            InitializeData();
        }

        private void InitializeData()
        {
            _products = AppData.Products;
            _weeklyMenu = AppData.WeeklyMenu;
            _shoppingList = AppData.ShoppingList;
            _activeTimers = new ObservableCollection<TimerItem>();

            ProductsListView.ItemsSource = _products;
            WeeklyMenuItemsControl.ItemsSource = _weeklyMenu;
            ActiveTimersItemsControl.ItemsSource = _activeTimers;
            ShoppingListListView.ItemsSource = _shoppingList;

            UpdateNoTimersVisibility();
        }

        private async void AddProduct_Click(object sender, RoutedEventArgs e)
        {
            if (!string.IsNullOrWhiteSpace(NewProductTextBox.Text))
            {
                var product = NewProductTextBox.Text.Trim();
                _products.Add(product);
                NewProductTextBox.Clear();

                await SaveProductToInventory(product);
            }
        }

        private async Task SaveProductToInventory(string productName)
        {
            try
            {
                Console.WriteLine($"Saving product to inventory: {productName}");

                var success = await AppData.ApiService.AddToInventoryByNameAsync(productName, 1, "шт");

                if (success)
                {
                    Console.WriteLine($"Product {productName} added to inventory successfully");
                }
                else
                {
                    Console.WriteLine($"Failed to add {productName} to inventory, adding locally");
                    AppData.Products.Add(productName);
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine($"Error saving product to inventory: {ex.Message}");
                AppData.Products.Add(productName);
            }
        }

        private void RemoveProduct_Click(object sender, RoutedEventArgs e)
        {
            if (sender is Button button && button.DataContext is string product)
            {
                _products.Remove(product);
            }
        }

        

        private async void OpenRecipe_Click(object sender, RoutedEventArgs e)
        {
            if (sender is Button button && button.DataContext is DailyMenu dailyMenu)
            {
                try
                {
                    if (dailyMenu.RecipeId > 0)
                    {
                        var recipe = await AppData.ApiService.GetRecipeAsync(dailyMenu.RecipeId);

                        if (recipe != null)
                        {
                            var detailsPage = new RecipeDetailsPage(
                                recipe.Title,
                                recipe.Description,
                                recipe.ImageUrl,
                                recipe.Ingredients.ConvertAll(i => $"{i.Name} - {i.Quantity} {i.Unit}"),
                                recipe.Instructions
                            );

                            MainWindow.mainWindow.OpenPages(detailsPage);
                            return;
                        }
                    }

                    var recipeByName = AppData.AllRecipes.FirstOrDefault(r =>
                        r.Title.Equals(dailyMenu.Meal, StringComparison.OrdinalIgnoreCase));

                    if (recipeByName != null)
                    {
                        var detailsPage = new RecipeDetailsPage(
                            recipeByName.Title,
                            recipeByName.Description,
                            recipeByName.ImageUrl,
                            recipeByName.Ingredients.ConvertAll(i => $"{i.Name} - {i.Quantity} {i.Unit}"),
                            recipeByName.Instructions
                        );

                        MainWindow.mainWindow.OpenPages(detailsPage);
                    }
                    else
                    {
                        MessageBox.Show("Рецепт не найден", "Ошибка");
                    }
                }
                catch (Exception ex)
                {
                    MessageBox.Show($"Ошибка загрузки рецепта: {ex.Message}");
                }
            }
        }

        private void OpenFavorites_Click(object sender, RoutedEventArgs e)
        {
            MainWindow.mainWindow.OpenPages(new FavoritesPage());
        }

        private void StartTimer_Click(object sender, RoutedEventArgs e)
        {
            if (sender is Button button && button.DataContext is DailyMenu menu)
            {
                var timerWindow = new TimerWindow(menu.Meal);
                if (timerWindow.ShowDialog() == true)
                {
                    var timerItem = new TimerItem
                    {
                        Name = menu.Meal,
                        EndTime = DateTime.Now.AddMinutes(timerWindow.SelectedMinutes),
                        Timer = new System.Windows.Threading.DispatcherTimer()
                    };

                    timerItem.Timer.Interval = TimeSpan.FromSeconds(1);
                    timerItem.Timer.Tick += (s, args) => UpdateTimer(timerItem);
                    timerItem.Timer.Start();

                    _activeTimers.Add(timerItem);
                    UpdateNoTimersVisibility();
                    UpdateTimer(timerItem);
                }
            }
        }

        private void UpdateTimer(TimerItem timerItem)
        {
            var timeLeft = timerItem.EndTime - DateTime.Now;

            if (timeLeft.TotalSeconds <= 0)
            {
                timerItem.Timer.Stop();
                timerItem.TimeLeft = "Время вышло!";
                MessageBox.Show($"Таймер '{timerItem.Name}' завершил работу!", "Таймер",
                              MessageBoxButton.OK, MessageBoxImage.Information);
            }
            else
            {
                timerItem.TimeLeft = $"{timeLeft:mm\\:ss}";
            }

            var index = _activeTimers.IndexOf(timerItem);
            if (index >= 0)
            {
                _activeTimers[index] = timerItem;
            }
        }

        private void StopTimer_Click(object sender, RoutedEventArgs e)
        {
            if (sender is Button button && button.DataContext is TimerItem timerItem)
            {
                timerItem.Timer.Stop();
                _activeTimers.Remove(timerItem);
                UpdateNoTimersVisibility();
            }
        }

        private void UpdateNoTimersVisibility()
        {
            NoTimersText.Visibility = _activeTimers.Count == 0 ? Visibility.Visible : Visibility.Collapsed;
        }

        private void ShoppingItem_Checked(object sender, RoutedEventArgs e)
        {
        }

        private async void ExportShoppingList_Click(object sender, RoutedEventArgs e)
        {
            try
            {
                var saveDialog = new Microsoft.Win32.SaveFileDialog
                {
                    Filter = "Текстовые файлы (*.txt)|*.txt",
                    FileName = "Список_покупок.txt"
                };

                if (saveDialog.ShowDialog() == true)
                {
                    var lines = new List<string> { "Список покупок:", "==================" };
                    foreach (var item in _shoppingList)
                    {
                        lines.Add($"- {item}");
                    }
                    System.IO.File.WriteAllLines(saveDialog.FileName, lines);

                    MessageBox.Show("Список покупок экспортирован!", "Успех",
                                  MessageBoxButton.OK, MessageBoxImage.Information);
                }
            }
            catch (Exception ex)
            {
                MessageBox.Show($"Ошибка при экспорте: {ex.Message}", "Ошибка",
                              MessageBoxButton.OK, MessageBoxImage.Error);
            }
        }

        private void BackButton_Click(object sender, RoutedEventArgs e)
        {
            foreach (var timer in _activeTimers)
            {
                timer.Timer.Stop();
            }

            AppData.Logout();
            MainWindow.mainWindow.OpenPages(new LogInPage());
        }

        private void OtherAllergiesTextBox_TextChanged(object sender, TextChangedEventArgs e)
        {
        }

        private async void RefreshData_Click(object sender, RoutedEventArgs e)
        {
            try
            {
                await AppData.LoadInitialData();
                MessageBox.Show("Данные обновлены", "Успех");
            }
            catch (Exception ex)
            {
                MessageBox.Show($"Ошибка обновления: {ex.Message}", "Ошибка");
            }
        }
    }

    public class TimerWindow : Window
    {
        public int SelectedMinutes { get; private set; } = 10;

        public TimerWindow(string mealName)
        {
            InitializeComponent();
            Title = $"Таймер для: {mealName}";
        }

        private void InitializeComponent()
        {
            Width = 300;
            Height = 200;
            WindowStartupLocation = WindowStartupLocation.CenterOwner;
            ResizeMode = ResizeMode.NoResize;

            var stackPanel = new StackPanel { Margin = new Thickness(20) };

            stackPanel.Children.Add(new TextBlock
            {
                Text = "Установите время таймера (минуты):",
                Foreground = Brushes.White,
                Margin = new Thickness(0, 0, 0, 10)
            });

            var slider = new Slider
            {
                Minimum = 1,
                Maximum = 120,
                Value = SelectedMinutes,
                Margin = new Thickness(0, 0, 0, 10)
            };
            slider.ValueChanged += (s, e) => SelectedMinutes = (int)e.NewValue;
            stackPanel.Children.Add(slider);

            var valueText = new TextBlock
            {
                Text = $"{SelectedMinutes} мин.",
                Foreground = Brushes.White,
                HorizontalAlignment = HorizontalAlignment.Center,
                Margin = new Thickness(0, 0, 0, 20)
            };
            stackPanel.Children.Add(valueText);

            slider.ValueChanged += (s, e) =>
            {
                SelectedMinutes = (int)e.NewValue;
                valueText.Text = $"{SelectedMinutes} мин.";
            };

            var buttonPanel = new StackPanel { Orientation = Orientation.Horizontal, HorizontalAlignment = HorizontalAlignment.Center };

            var okButton = new Button
            {
                Content = "Запустить",
                Background = new SolidColorBrush(Color.FromRgb(76, 175, 80)),
                Foreground = Brushes.White,
                Margin = new Thickness(0, 0, 10, 0)
            };
            okButton.Click += (s, e) => { DialogResult = true; Close(); };
            buttonPanel.Children.Add(okButton);

            var cancelButton = new Button
            {
                Content = "Отмена",
                Background = new SolidColorBrush(Color.FromRgb(244, 67, 54)),
                Foreground = Brushes.White,
            };
            cancelButton.Click += (s, e) => { DialogResult = false; Close(); };
            buttonPanel.Children.Add(cancelButton);

            stackPanel.Children.Add(buttonPanel);

            Content = stackPanel;
            Background = new SolidColorBrush(Color.FromRgb(30, 30, 30));
        }
    }
}﻿// RegIn.xaml.cs
using System;
using System.Collections.Generic;
using System.Text.RegularExpressions;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Input;
using UP.Models;
using UP.Services;

namespace UP.Pages
{
    public partial class RegIn : Page
    {
        public RegIn()
        {
            InitializeComponent();
            Loaded += (s, e) => UsernameTextBox.Focus();

            // Обработка Enter для быстрой навигации
            UsernameTextBox.KeyDown += TextBox_KeyDown;
            EmailTextBox.KeyDown += TextBox_KeyDown;
            PasswordBox.KeyDown += TextBox_KeyDown;
            ConfirmPasswordBox.KeyDown += TextBox_KeyDown;
        }

        private void TextBox_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.Key == Key.Enter)
            {
                if (sender == UsernameTextBox)
                    EmailTextBox.Focus();
                else if (sender == EmailTextBox)
                    PasswordBox.Focus();
                else if (sender == PasswordBox)
                    ConfirmPasswordBox.Focus();
                else if (sender == ConfirmPasswordBox)
                    RegisterButton_Click(null, null);
            }
        }

        private async void RegisterButton_Click(object sender, RoutedEventArgs e)
        {
            if (!ValidateForm())
                return;

            try
            {
                // Регистрация пользователя через API
                var user = await AppData.ApiService.RegisterAsync(
                    UsernameTextBox.Text.Trim(),
                    EmailTextBox.Text.Trim(),
                    PasswordBox.Password,
                    new List<string>()); // Аллергии можно добавить позже

                AppData.InitializeAfterLogin(user);

                // Возврат на страницу входа
                NavigationService?.Navigate(new LogInPage());

                MessageBox.Show("Регистрация успешна! Теперь вы можете войти в систему.",
                              "Успешная регистрация",
                              MessageBoxButton.OK, MessageBoxImage.Information);
            }
            catch (Exception ex)
            {
                ShowError($"Ошибка регистрации: {ex.Message}");
            }
        }

        private bool ValidateForm()
        {
            // Проверка имени пользователя
            if (string.IsNullOrWhiteSpace(UsernameTextBox.Text))
            {
                ShowError("Введите имя пользователя");
                UsernameTextBox.Focus();
                return false;
            }

            if (UsernameTextBox.Text.Length < 3)
            {
                ShowError("Имя пользователя должно содержать минимум 3 символа");
                UsernameTextBox.Focus();
                return false;
            }

            // Проверка email
            if (string.IsNullOrWhiteSpace(EmailTextBox.Text))
            {
                ShowError("Введите email");
                EmailTextBox.Focus();
                return false;
            }

            if (!IsValidEmail(EmailTextBox.Text))
            {
                ShowError("Введите корректный email адрес");
                EmailTextBox.Focus();
                return false;
            }

            // Проверка пароля
            if (string.IsNullOrWhiteSpace(PasswordBox.Password))
            {
                ShowError("Введите пароль");
                PasswordBox.Focus();
                return false;
            }

            if (PasswordBox.Password.Length < 6)
            {
                ShowError("Пароль должен содержать минимум 6 символов");
                PasswordBox.Focus();
                return false;
            }

            // Проверка подтверждения пароля
            if (PasswordBox.Password != ConfirmPasswordBox.Password)
            {
                ShowError("Пароли не совпадают");
                ConfirmPasswordBox.Focus();
                return false;
            }

            return true;
        }

        private bool IsValidEmail(string email)
        {
            try
            {
                var regex = new Regex(@"^[^@\s]+@[^@\s]+\.[^@\s]+$");
                return regex.IsMatch(email);
            }
            catch
            {
                return false;
            }
        }

        private void ShowError(string message)
        {
            MessageBox.Show(message, "Ошибка валидации",
                          MessageBoxButton.OK, MessageBoxImage.Warning);
        }

        private void BackButton_Click(object sender, RoutedEventArgs e)
        {
            NavigationService?.Navigate(new LogInPage());
        }

        private void LoginText_MouseLeftButtonDown(object sender, MouseButtonEventArgs e)
        {
            NavigationService?.Navigate(new LogInPage());
        }
    }
}﻿using System.Reflection;
using System.Resources;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;
using System.Windows;

// Общие сведения об этой сборке предоставляются следующим набором
// набор атрибутов. Измените значения этих атрибутов, чтобы изменить сведения,
// связанные со сборкой.
[assembly: AssemblyTitle("UP")]
[assembly: AssemblyDescription("")]
[assembly: AssemblyConfiguration("")]
[assembly: AssemblyCompany("")]
[assembly: AssemblyProduct("UP")]
[assembly: AssemblyCopyright("Copyright ©  2025")]
[assembly: AssemblyTrademark("")]
[assembly: AssemblyCulture("")]

// Установка значения False для параметра ComVisible делает типы в этой сборке невидимыми
// для компонентов COM. Если необходимо обратиться к типу в этой сборке через
// из модели COM, установите атрибут ComVisible для этого типа в значение true.
[assembly: ComVisible(false)]

//Чтобы начать создание локализуемых приложений, задайте
//<UICulture>CultureYouAreCodingWith</UICulture> в файле .csproj
//в <PropertyGroup>. Например, при использовании английского (США)
//в своих исходных файлах установите <UICulture> в en-US.  Затем отмените преобразование в комментарий
//атрибута NeutralResourceLanguage ниже.  Обновите "en-US" в
//строка внизу для обеспечения соответствия настройки UICulture в файле проекта.

//[assembly: NeutralResourcesLanguage("en-US", UltimateResourceFallbackLocation.Satellite)]


[assembly: ThemeInfo(
    ResourceDictionaryLocation.None, //где расположены словари ресурсов по конкретным тематикам
                                     //(используется, если ресурс не найден на странице,
                                     // или в словарях ресурсов приложения)
    ResourceDictionaryLocation.SourceAssembly //где расположен словарь универсальных ресурсов
                                              //(используется, если ресурс не найден на странице,
                                              // в приложении или в каких-либо словарях ресурсов для конкретной темы)
)]


// Сведения о версии для сборки включают четыре следующих значения:
//
//      Основной номер версии
//      Дополнительный номер версии
//      Номер сборки
//      Номер редакции
//
[assembly: AssemblyVersion("1.0.0.0")]
[assembly: AssemblyFileVersion("1.0.0.0")]
﻿//------------------------------------------------------------------------------
// <auto-generated>
//     Этот код был создан программным средством.
//     Версия среды выполнения: 4.0.30319.42000
//
//     Изменения в этом файле могут привести к неправильному поведению и будут утрачены, если
//     код создан повторно.
// </auto-generated>
//------------------------------------------------------------------------------

namespace UP.Properties
{


    /// <summary>
    ///   Класс ресурсов со строгим типом для поиска локализованных строк и пр.
    /// </summary>
    // Этот класс был автоматически создан при помощи StronglyTypedResourceBuilder
    // класс с помощью таких средств, как ResGen или Visual Studio.
    // Для добавления или удаления члена измените файл .ResX, а затем перезапустите ResGen
    // с параметром /str или заново постройте свой VS-проект.
    [global::System.CodeDom.Compiler.GeneratedCodeAttribute("System.Resources.Tools.StronglyTypedResourceBuilder", "4.0.0.0")]
    [global::System.Diagnostics.DebuggerNonUserCodeAttribute()]
    [global::System.Runtime.CompilerServices.CompilerGeneratedAttribute()]
    internal class Resources
    {

        private static global::System.Resources.ResourceManager resourceMan;

        private static global::System.Globalization.CultureInfo resourceCulture;

        [global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode")]
        internal Resources()
        {
        }

        /// <summary>
        ///   Возврат кэшированного экземпляра ResourceManager, используемого этим классом.
        /// </summary>
        [global::System.ComponentModel.EditorBrowsableAttribute(global::System.ComponentModel.EditorBrowsableState.Advanced)]
        internal static global::System.Resources.ResourceManager ResourceManager
        {
            get
            {
                if ((resourceMan == null))
                {
                    global::System.Resources.ResourceManager temp = new global::System.Resources.ResourceManager("UP.Properties.Resources", typeof(Resources).Assembly);
                    resourceMan = temp;
                }
                return resourceMan;
            }
        }

        /// <summary>
        ///   Переопределяет свойство CurrentUICulture текущего потока для всех
        ///   подстановки ресурсов с помощью этого класса ресурсов со строгим типом.
        /// </summary>
        [global::System.ComponentModel.EditorBrowsableAttribute(global::System.ComponentModel.EditorBrowsableState.Advanced)]
        internal static global::System.Globalization.CultureInfo Culture
        {
            get
            {
                return resourceCulture;
            }
            set
            {
                resourceCulture = value;
            }
        }
    }
}
﻿//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:4.0.30319.42000
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

namespace UP.Properties
{


    [global::System.Runtime.CompilerServices.CompilerGeneratedAttribute()]
    [global::System.CodeDom.Compiler.GeneratedCodeAttribute("Microsoft.VisualStudio.Editors.SettingsDesigner.SettingsSingleFileGenerator", "11.0.0.0")]
    internal sealed partial class Settings : global::System.Configuration.ApplicationSettingsBase
    {

        private static Settings defaultInstance = ((Settings)(global::System.Configuration.ApplicationSettingsBase.Synchronized(new Settings())));

        public static Settings Default
        {
            get
            {
                return defaultInstance;
            }
        }
    }
}
﻿using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace UP.Services
{
    internal class ApiClient
    {
    }
}
using System;
using System.Collections.Generic;
using System.Linq;
using System.Net.Http;
using System.Net.Http.Headers;
using System.Text;
using System.Threading.Tasks;
using Newtonsoft.Json;
using UP.Models;

namespace UP.Services
{
    public class ApiService
    {
        private readonly HttpClient _httpClient;
        private string _baseUrl;
        private string _token;

        public ApiService(string baseUrl = "https://localhost:7197/api/")
        {
            _baseUrl = baseUrl;

            var handler = new HttpClientHandler
            {
                ServerCertificateCustomValidationCallback = (message, cert, chain, errors) => true
            };

            _httpClient = new HttpClient(handler);
            _httpClient.Timeout = TimeSpan.FromSeconds(30);
            _httpClient.DefaultRequestHeaders.Accept.Add(
                new MediaTypeWithQualityHeaderValue("application/json"));
            _httpClient.DefaultRequestHeaders.AcceptCharset.Add(new StringWithQualityHeaderValue("utf-8"));
        }

        public void SetToken(string token)
        {
            _token = token;
            // Не устанавливаем заголовок Authorization, если API не использует Bearer
        }

        public void ClearToken()
        {
            _token = null;
        }

        public async Task<UserData> LoginAsync(string username, string password)
        {
            try
            {
                Console.WriteLine($"Попытка входа для пользователя: {username}");

                var formData = new Dictionary<string, string>
                {
                    { "username", username },
                    { "password", password }
                };

                var content = new FormUrlEncodedContent(formData);

                Console.WriteLine($"Отправка запроса на: {_baseUrl}Auth/login");

                var response = await _httpClient.PostAsync($"{_baseUrl}Auth/login", content);

                Console.WriteLine($"Статус ответа: {response.StatusCode}");

                var responseString = await response.Content.ReadAsStringAsync();
                Console.WriteLine($"Содержимое ответа: {responseString}");

                if (!response.IsSuccessStatusCode)
                {
                    var errorContent = await response.Content.ReadAsStringAsync();
                    Console.WriteLine($"Ошибка HTTP: {response.StatusCode}, Контент: {errorContent}");
                    throw new HttpRequestException($"Ошибка входа: {response.StatusCode}. {errorContent}");
                }

                // Парсим ответ
                var responseObject = JsonConvert.DeserializeObject<dynamic>(responseString);
                Console.WriteLine($"Распарсенный объект: {responseObject}");

                if (responseObject != null)
                {
                    var userData = new UserData();

                    // Формат ответа из вашего примера
                    userData.Id = responseObject.id ?? 0;
                    userData.Username = responseObject.username ?? username;
                    userData.Email = responseObject.email ?? "";
                    userData.FullName = responseObject.fullName ?? username;

                    // Не используем токен, так как API его не возвращает
                    Console.WriteLine($"Вход успешен для пользователя: {userData.Username}, ID: {userData.Id}");

                    return userData;
                }
                else
                {
                    var errorMessage = responseObject?.message?.ToString() ?? "Ошибка входа";
                    Console.WriteLine($"Ошибка входа: {errorMessage}");
                    throw new Exception(errorMessage);
                }
            }
            catch (JsonException jsonEx)
            {
                Console.WriteLine($"Ошибка парсинга JSON: {jsonEx.Message}");
                throw new Exception($"Ошибка обработки ответа от сервера: {jsonEx.Message}");
            }
            catch (HttpRequestException httpEx)
            {
                Console.WriteLine($"Ошибка сети: {httpEx.Message}");
                throw new HttpRequestException($"Ошибка сети: {httpEx.Message}. Проверьте, запущен ли сервер API.", httpEx);
            }
            catch (Exception ex)
            {
                Console.WriteLine($"Общая ошибка входа: {ex.Message}");
                Console.WriteLine($"StackTrace: {ex.StackTrace}");
                throw new Exception($"Ошибка входа: {ex.Message}");
            }
        }

        public async Task<UserData> RegisterAsync(string username, string email, string password, List<string> allergies)
        {
            try
            {
                Console.WriteLine($"Регистрация пользователя: {username}, email: {email}");

                var formData = new Dictionary<string, string>
                {
                    { "username", username },
                    { "email", email },
                    { "password", password },
                    { "fullName", username }
                };

                var content = new FormUrlEncodedContent(formData);
                var response = await _httpClient.PostAsync($"{_baseUrl}Auth/register", content);

                var responseString = await response.Content.ReadAsStringAsync();
                Console.WriteLine($"Ответ регистрации: {responseString}");

                if (!response.IsSuccessStatusCode)
                {
                    var errorContent = await response.Content.ReadAsStringAsync();
                    throw new HttpRequestException($"Ошибка регистрации: {response.StatusCode}. {errorContent}");
                }

                var responseObject = JsonConvert.DeserializeObject<dynamic>(responseString);

                if (responseObject != null && responseObject.success == true)
                {
                    return new UserData
                    {
                        Id = responseObject.data?.Id ?? responseObject.id ?? 0,
                        Username = responseObject.data?.Username ?? responseObject.username ?? username,
                        Email = responseObject.data?.Email ?? responseObject.email ?? email,
                        FullName = responseObject.data?.FullName ?? responseObject.fullName ?? username
                    };
                }
                else
                {
                    throw new Exception(responseObject?.message?.ToString() ?? "Ошибка регистрации");
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine($"Ошибка регистрации: {ex.Message}");
                throw new Exception($"Ошибка регистрации: {ex.Message}");
            }
        }

        // Остальные методы (GetRecipesAsync, GetRecipeAsync и т.д.) оставляем без изменений
        // Только убираем из них любые упоминания Authorization header

        public async Task<List<RecipeDto>> GetRecipesAsync()
        {
            try
            {
                var response = await _httpClient.GetAsync($"{_baseUrl}Recipes");
                var responseString = await response.Content.ReadAsStringAsync();
                var responseObject = JsonConvert.DeserializeObject<dynamic>(responseString);

                if (responseObject != null && responseObject.success == true)
                {
                    return JsonConvert.DeserializeObject<List<RecipeDto>>(responseObject.data.ToString());
                }

                return new List<RecipeDto>();
            }
            catch (Exception ex)
            {
                Console.WriteLine($"GetRecipesAsync error: {ex.Message}");
                return new List<RecipeDto>();
            }
        }

        public async Task<RecipeDto> GetRecipeAsync(int id)
        {
            try
            {
                var response = await _httpClient.GetAsync($"{_baseUrl}Recipes/{id}");
                var responseString = await response.Content.ReadAsStringAsync();
                var responseObject = JsonConvert.DeserializeObject<dynamic>(responseString);

                if (responseObject != null && responseObject.success == true)
                {
                    return JsonConvert.DeserializeObject<RecipeDto>(responseObject.data.ToString());
                }

                return null;
            }
            catch (Exception ex)
            {
                Console.WriteLine($"GetRecipeAsync error: {ex.Message}");
                return null;
            }
        }

        public async Task<List<RecipeDto>> GetFavoritesAsync()
        {
            try
            {
                var userId = AppData.CurrentUser?.Id ?? 0;
                var response = await _httpClient.GetAsync($"{_baseUrl}Recipes/favorites/{userId}");
                var responseString = await response.Content.ReadAsStringAsync();
                var responseObject = JsonConvert.DeserializeObject<dynamic>(responseString);

                if (responseObject != null && responseObject.success == true)
                {
                    return JsonConvert.DeserializeObject<List<RecipeDto>>(responseObject.data.ToString());
                }

                return new List<RecipeDto>();
            }
            catch (Exception ex)
            {
                Console.WriteLine($"GetFavoritesAsync error: {ex.Message}");
                return new List<RecipeDto>();
            }
        }

        public async Task<bool> ToggleFavoriteAsync(int recipeId)
        {
            try
            {
                var userId = AppData.CurrentUser?.Id ?? 0;
                var formData = new Dictionary<string, string>();
                var content = new FormUrlEncodedContent(formData);
                var response = await _httpClient.PostAsync($"{_baseUrl}Recipes/{recipeId}/favorite/{userId}", content);

                var responseString = await response.Content.ReadAsStringAsync();
                var responseObject = JsonConvert.DeserializeObject<dynamic>(responseString);

                return responseObject != null && responseObject.success == true;
            }
            catch (Exception ex)
            {
                Console.WriteLine($"ToggleFavoriteAsync error: {ex.Message}");
                return false;
            }
        }


        public async Task<MenuDto> GetCurrentMenuAsync()
        {
            try
            {
                var userId = AppData.CurrentUser?.Id ?? 0;
                var response = await _httpClient.GetAsync($"{_baseUrl}Menu/current/{userId}");
                var responseString = await response.Content.ReadAsStringAsync();
                var responseObject = JsonConvert.DeserializeObject<dynamic>(responseString);

                if (responseObject != null && responseObject.success == true)
                {
                    return JsonConvert.DeserializeObject<MenuDto>(responseObject.data.ToString());
                }

                return null;
            }
            catch (Exception ex)
            {
                Console.WriteLine($"GetCurrentMenuAsync error: {ex.Message}");
                return null;
            }
        }

        public async Task<ShoppingListDto> GetCurrentShoppingListAsync()
        {
            try
            {
                var userId = AppData.CurrentUser?.Id ?? 0;
                var response = await _httpClient.GetAsync($"{_baseUrl}ShoppingList/current/{userId}");
                var responseString = await response.Content.ReadAsStringAsync();
                var responseObject = JsonConvert.DeserializeObject<dynamic>(responseString);

                if (responseObject != null && responseObject.success == true)
                {
                    return JsonConvert.DeserializeObject<ShoppingListDto>(responseObject.data.ToString());
                }

                return null;
            }
            catch (Exception ex)
            {
                Console.WriteLine($"GetCurrentShoppingListAsync error: {ex.Message}");
                return null;
            }
        }

        public async Task<bool> GenerateShoppingListAsync(int menuId)
        {
            try
            {
                var userId = AppData.CurrentUser?.Id ?? 0;
                var formData = new MultipartFormDataContent();
                var response = await _httpClient.PostAsync($"{_baseUrl}ShoppingList/generate-from-menu/{menuId}/{userId}", formData);

                var responseString = await response.Content.ReadAsStringAsync();
                Console.WriteLine($"GenerateShoppingListAsync response: {responseString}");

                var responseObject = JsonConvert.DeserializeObject<dynamic>(responseString);
                return responseObject != null && responseObject.success == true;
            }
            catch (Exception ex)
            {
                Console.WriteLine($"GenerateShoppingListAsync error: {ex.Message}");
                return false;
            }
        }

        public async Task<List<IngredientDto>> GetIngredientsAsync()
        {
            try
            {
                var response = await _httpClient.GetAsync($"{_baseUrl}Recipes/ingredients");
                var responseString = await response.Content.ReadAsStringAsync();
                var responseObject = JsonConvert.DeserializeObject<dynamic>(responseString);

                if (responseObject != null && responseObject.success == true)
                {
                    return JsonConvert.DeserializeObject<List<IngredientDto>>(responseObject.data.ToString());
                }

                return new List<IngredientDto>();
            }
            catch (Exception ex)
            {
                Console.WriteLine($"GetIngredientsAsync error: {ex.Message}");
                return new List<IngredientDto>();
            }
        }

        public async Task<bool> AddToInventoryAsync(int ingredientId, decimal quantity, string unit)
        {
            try
            {
                var userId = AppData.CurrentUser?.Id ?? 0;
                if (userId == 0)
                {
                    Console.WriteLine("User not logged in, cannot add to inventory");
                    return false;
                }

                var ingredients = await GetIngredientsAsync();
                var ingredient = ingredients.FirstOrDefault(i => i.Id == ingredientId);

                if (ingredient == null)
                {
                    Console.WriteLine($"Ingredient with ID {ingredientId} not found");
                    return false;
                }

                var formData = new Dictionary<string, string>
                {
                    { "productName", ingredient.Name },
                    { "quantity", quantity.ToString() },
                    { "unit", unit }
                };

                var content = new FormUrlEncodedContent(formData);
                var response = await _httpClient.PostAsync($"{_baseUrl}Inventory/add/{userId}", content);

                var responseString = await response.Content.ReadAsStringAsync();
                Console.WriteLine($"AddToInventory response: {responseString}");

                if (!response.IsSuccessStatusCode)
                {
                    Console.WriteLine($"AddToInventory failed: {response.StatusCode}");
                    return false;
                }

                try
                {
                    var responseObject = JsonConvert.DeserializeObject<dynamic>(responseString);
                    return responseObject != null && responseObject.success == true;
                }
                catch (JsonException)
                {
                    return response.IsSuccessStatusCode;
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine($"AddToInventoryAsync error: {ex.Message}");
                return false;
            }
        }

        public async Task<bool> AddToInventoryByNameAsync(string productName, decimal quantity = 1, string unit = "шт")
        {
            try
            {
                var userId = AppData.CurrentUser?.Id ?? 0;
                if (userId == 0)
                {
                    Console.WriteLine("User not logged in, cannot add to inventory");
                    return false;
                }

                var formData = new Dictionary<string, string>
                {
                    { "productName", productName },
                    { "quantity", quantity.ToString() },
                    { "unit", unit }
                };

                var content = new FormUrlEncodedContent(formData);
                var response = await _httpClient.PostAsync($"{_baseUrl}Inventory/add/{userId}", content);

                var responseString = await response.Content.ReadAsStringAsync();
                Console.WriteLine($"AddToInventoryByName response: {responseString}");

                if (!response.IsSuccessStatusCode)
                {
                    Console.WriteLine($"AddToInventoryByName failed: {response.StatusCode}");
                    return false;
                }

                try
                {
                    var responseObject = JsonConvert.DeserializeObject<dynamic>(responseString);
                    return responseObject != null && responseObject.success == true;
                }
                catch (JsonException)
                {
                    return response.IsSuccessStatusCode;
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine($"AddToInventoryByNameAsync error: {ex.Message}");
                return false;
            }
        }
    }
}﻿//using System;
//using System.Collections.Generic;
//using MySql.Data.MySqlClient;
//using Newtonsoft.Json;

//namespace UP.Services
//{
//    public class DatabaseServiceMySQL
//    {
//        private readonly string _connectionString;

//        public DatabaseServiceMySQL(string server = "localhost", string database = "recipes_db", string user = "root", string password = "root")
//        {
//            _connectionString = $"Server={server};Database={database};Uid={user};Pwd={password};Charset=utf8mb4;";
//            InitializeDatabase();
//        }

//        private void InitializeDatabase()
//        {
//            var conn = new MySqlConnection(_connectionString);
//            conn.Open();

//            var cmd = conn.CreateCommand();
//            cmd.CommandText = @"
//                CREATE TABLE IF NOT EXISTS recipes (
//                    id VARCHAR(36) PRIMARY KEY,
//                    title VARCHAR(255) NOT NULL,
//                    ingredients_json TEXT,
//                    steps_json TEXT,
//                    tags_json TEXT,
//                    calories INT DEFAULT 0,
//                    photo_path VARCHAR(255)
//                );

//                CREATE TABLE IF NOT EXISTS ingredients (
//                    id VARCHAR(36) PRIMARY KEY,
//                    name VARCHAR(255) NOT NULL,
//                    category VARCHAR(100),
//                    allergens_json TEXT
//                );

//                CREATE TABLE IF NOT EXISTS menus (
//                    id VARCHAR(36) PRIMARY KEY,
//                    user_id VARCHAR(36),
//                    created_at DATETIME,
//                    menu_json TEXT
//                );

//                CREATE TABLE IF NOT EXISTS favorites (
//                    recipe_id VARCHAR(36) PRIMARY KEY,
//                    added_at DATETIME
//                );
//            ";
//            cmd.ExecuteNonQuery();
//        }

//        private MySqlConnection GetConnection()
//        {
//            var conn = new MySqlConnection(_connectionString);
//            conn.Open();
//            return conn;
//        }

//        // Добавление или обновление рецепта
//        public void InsertOrUpdateRecipe(string id, string title, string ingredientsJson, string stepsJson, string tagsJson, int calories = 0, string photoPath = null)
//        {
//            var conn = GetConnection();
//            var cmd = conn.CreateCommand();
//            cmd.CommandText = @"
//                INSERT INTO recipes (id, title, ingredients_json, steps_json, tags_json, calories, photo_path)
//                VALUES (@id, @title, @ingredients_json, @steps_json, @tags_json, @calories, @photo_path)
//                ON DUPLICATE KEY UPDATE
//                    title = VALUES(title),
//                    ingredients_json = VALUES(ingredients_json),
//                    steps_json = VALUES(steps_json),
//                    tags_json = VALUES(tags_json),
//                    calories = VALUES(calories),
//                    photo_path = VALUES(photo_path);
//            ";
//            cmd.Parameters.AddWithValue("@id", id);
//            cmd.Parameters.AddWithValue("@title", title);
//            cmd.Parameters.AddWithValue("@ingredients_json", ingredientsJson ?? "");
//            cmd.Parameters.AddWithValue("@steps_json", stepsJson ?? "");
//            cmd.Parameters.AddWithValue("@tags_json", tagsJson ?? "");
//            cmd.Parameters.AddWithValue("@calories", calories);
//            cmd.Parameters.AddWithValue("@photo_path", photoPath ?? "");
//            cmd.ExecuteNonQuery();
//        }

//        public IEnumerable<(string id, string title, string ingredientsJson, string stepsJson, string tagsJson, int calories, string photo)> GetAllRecipes()
//        {
//            var conn = GetConnection();
//            var cmd = conn.CreateCommand();
//            cmd.CommandText = "SELECT id, title, ingredients_json, steps_json, tags_json, calories, photo_path FROM recipes ORDER BY title;";
//            var reader = cmd.ExecuteReader();

//            while (reader.Read())
//            {
//                yield return (
//                    reader.GetString("id"),
//                    reader.GetString("title"),
//                    reader.IsDBNull("ingredients_json") ? "" : reader.GetString("ingredients_json"),
//                    reader.IsDBNull("steps_json") ? "" : reader.GetString("steps_json"),
//                    reader.IsDBNull("tags_json") ? "" : reader.GetString("tags_json"),
//                    reader.IsDBNull("calories") ? 0 : reader.GetInt32("calories"),
//                    reader.IsDBNull("photo_path") ? "" : reader.GetString("photo_path")
//                );
//            }
//        }

//        public void SaveMenu(string id, string userId, string menuJson)
//        {
//            var conn = GetConnection();
//            var cmd = conn.CreateCommand();
//            cmd.CommandText = @"
//                INSERT INTO menus (id, user_id, created_at, menu_json)
//                VALUES (@id, @user_id, @created_at, @menu_json)
//                ON DUPLICATE KEY UPDATE
//                    menu_json = VALUES(menu_json),
//                    created_at = VALUES(created_at);
//            ";
//            cmd.Parameters.AddWithValue("@id", id);
//            cmd.Parameters.AddWithValue("@user_id", userId ?? "");
//            cmd.Parameters.AddWithValue("@created_at", DateTime.UtcNow);
//            cmd.Parameters.AddWithValue("@menu_json", menuJson ?? "");
//            cmd.ExecuteNonQuery();
//        }

//        public void AddFavorite(string recipeId)
//        {
//            var conn = GetConnection();
//            var cmd = conn.CreateCommand();
//            cmd.CommandText = "INSERT INTO favorites (recipe_id, added_at) VALUES (@id, @added_at) ON DUPLICATE KEY UPDATE added_at = VALUES(added_at);";
//            cmd.Parameters.AddWithValue("@id", recipeId);
//            cmd.Parameters.AddWithValue("@added_at", DateTime.UtcNow);
//            cmd.ExecuteNonQuery();
//        }

//        public void RemoveFavorite(string recipeId)
//        {
//            var conn = GetConnection();
//            var cmd = conn.CreateCommand();
//            cmd.CommandText = "DELETE FROM favorites WHERE recipe_id = @id;";
//            cmd.Parameters.AddWithValue("@id", recipeId);
//            cmd.ExecuteNonQuery();
//        }

//        public bool IsFavorite(string recipeId)
//        {
//            var conn = GetConnection();
//            var cmd = conn.CreateCommand();
//            cmd.CommandText = "SELECT 1 FROM favorites WHERE recipe_id = @id LIMIT 1;";
//            cmd.Parameters.AddWithValue("@id", recipeId);
//                var reader = cmd.ExecuteReader();
//            return reader.Read();
//        }
//    }
//}
using Microsoft.EntityFrameworkCore;
using Microsoft.OpenApi.Models;
using YP_API.Data;
using YP_API.Interfaces;
using YP_API.Repositories;
using YP_API.Services;

var builder = WebApplication.CreateBuilder(args);

builder.Services.AddCors(options =>
{
    options.AddPolicy("AllowAll", policy =>
    {
        policy.AllowAnyOrigin()
              .AllowAnyMethod()
              .AllowAnyHeader();
    });
});

builder.Services.AddControllers();
builder.Services.AddEndpointsApiExplorer();

builder.Services.AddSwaggerGen(c =>
{
    c.SwaggerDoc("v1", new OpenApiInfo
    {
        Title = "Recipe Planner API",
        Version = "v1",
        Description = "API for managing recipes, menus, shopping lists and ingredients"
    });
});

var connectionString = "Server=MySQL-8.2;Port=3306;Database=recipe_planner;Uid=root;Pwd=;ConnectionTimeout=60;";

builder.Services.AddDbContext<RecipePlannerContext>(options =>
{
    options.UseMySql(connectionString, ServerVersion.AutoDetect(connectionString));
});

builder.Services.AddScoped<IRecipeRepository, RecipeRepository>();
builder.Services.AddScoped<IUserRepository, UserRepository>();
builder.Services.AddScoped<IAuthService, AuthService>();

var app = builder.Build();

//    
using (var scope = app.Services.CreateScope())
{
    var dbContext = scope.ServiceProvider.GetRequiredService<RecipePlannerContext>();

    try
    {
        await dbContext.Database.EnsureCreatedAsync();
    }
    catch (Exception)
    {
        try
        {
            var connection = dbContext.Database.GetDbConnection();
            await connection.OpenAsync();
            var cmd = connection.CreateCommand();
            cmd.CommandText = "CREATE DATABASE IF NOT EXISTS recipe_planner CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci";
            await cmd.ExecuteNonQueryAsync();
            await dbContext.Database.EnsureCreatedAsync();
        }
        catch { }
    }
}

app.UseCors("AllowAll");

if (app.Environment.IsDevelopment())
{
    app.UseSwagger();
    app.UseSwaggerUI(c =>
    {
        c.SwaggerEndpoint("/swagger/v1/swagger.json", "Recipe Planner API v1");
        c.RoutePrefix = string.Empty;
    });
}

app.MapControllers();

//     ()
app.MapGet("/api/debug/db-status", async (RecipePlannerContext context) =>
{
    try
    {
        var canConnect = await context.Database.CanConnectAsync();
        return Results.Ok(new
        {
            success = true,
            database = "recipe_planner",
            connected = canConnect
        });
    }
    catch (Exception ex)
    {
        return Results.BadRequest(new
        {
            success = false,
            error = ex.Message
        });
    }
});

app.MapGet("/api/debug/create-db", async (RecipePlannerContext context) =>
{
    try
    {
        var created = await context.Database.EnsureCreatedAsync();
        return Results.Ok(new
        {
            success = true,
            created = created
        });
    }
    catch (Exception ex)
    {
        return Results.BadRequest(new
        {
            success = false,
            error = ex.Message
        });
    }
});

app.Run();﻿using Microsoft.AspNetCore.Mvc;
using YP_API.Services;

namespace YP_API.Controllers
{
    [ApiController]
    [Route("api/[controller]")]
    public class AuthController : ControllerBase
    {
        private readonly IAuthService _authService;

        public AuthController(IAuthService authService)
        {
            _authService = authService;
        }

        [HttpPost("login")]
        public async Task<ActionResult> Login(
            [FromForm] string username,
            [FromForm] string password)
        {
            try
            {
                var user = await _authService.Login(username, password);

                return Ok(new
                {
                    success = true,
                    id = user.Id,
                    username = user.Username,
                    email = user.Email,
                    message = "Успешный вход"
                });
            }
            catch (Exception ex)
            {
                return Unauthorized(new { error = ex.Message });
            }
        }

        [HttpPost("register")]
        public async Task<ActionResult> Register(
            [FromForm] string username,
            [FromForm] string password,
            [FromForm] string email)
        {
            try
            {
                var user = await _authService.Register(username, email, password);

                return Ok(new
                {
                    success = true,
                    id = user.Id,
                    username = user.Username,
                    email = user.Email,
                    message = "Пользователь создан"
                });
            }
            catch (Exception ex)
            {
                return BadRequest(new { error = ex.Message });
            }
        }
    }
}﻿using Microsoft.AspNetCore.Mvc;
using Microsoft.EntityFrameworkCore;
using YP_API.Data;
using YP_API.Models;

namespace YP_API.Controllers
{
    [ApiController]
    [Route("api/[controller]")]
    public class IngredientsController : ControllerBase
    {
        private readonly RecipePlannerContext _context;

        public IngredientsController(RecipePlannerContext context)
        {
            _context = context;
        }

        [HttpGet("search")]
        public async Task<ActionResult> SearchIngredients([FromQuery(Name = "name")] string? searchName)  // Добавил Name = "name" и ?
        {
            try
            {
                IQueryable<Ingredient> query = _context.Ingredients;

                if (!string.IsNullOrWhiteSpace(searchName))
                {
                    query = query.Where(i => i.Name.ToLower().Contains(searchName.ToLower()));
                }

                var ingredients = await query
                    .Take(50)
                    .ToListAsync();

                return Ok(new
                {
                    success = true,
                    data = ingredients.Select(i => new
                    {
                        Id = i.Id,
                        Name = i.Name,
                        Category = i.Category,
                        Unit = i.Unit
                    })
                });
            }
            catch (Exception ex)
            {
                return StatusCode(500, new { error = ex.Message });
            }
        }

        // Получение всех категорий
        [HttpGet("categories")]
        public async Task<ActionResult> GetCategories()
        {
            try
            {
                var categories = await _context.Ingredients
                    .Where(i => !string.IsNullOrEmpty(i.Category))
                    .Select(i => i.Category)
                    .Distinct()
                    .OrderBy(c => c)
                    .ToListAsync();

                return Ok(new
                {
                    success = true,
                    data = categories
                });
            }
            catch (Exception ex)
            {
                return StatusCode(500, new { error = ex.Message });
            }
        }
    }
}﻿using Microsoft.AspNetCore.Mvc;
using Microsoft.EntityFrameworkCore;
using YP_API.Data;
using YP_API.Models;

namespace YP_API.Controllers
{
    [ApiController]
    [Route("api/[controller]")]
    public class MenuController : ControllerBase
    {
        private readonly RecipePlannerContext _context;

        public MenuController(RecipePlannerContext context)
        {
            _context = context;
        }

        // ПОЛУЧИТЬ меню для выбора пользователем
        [HttpGet("available")]
        public async Task<ActionResult> GetAvailableMenus()
        {
            try
            {
                var menus = await _context.Menus
                    .Include(m => m.Items)
                        .ThenInclude(i => i.Recipe)
                    .Select(m => new
                    {
                        Id = m.Id,
                        Name = m.Name,
                        CreatedAt = m.CreatedAt,
                        TotalDays = m.Items.Select(i => i.Date.Date).Distinct().Count(),
                        Recipes = m.Items.Select(i => new
                        {
                            Id = i.RecipeId,
                            Title = i.Recipe.Title,
                            Date = i.Date.ToString("yyyy-MM-dd"),
                            MealType = i.MealType
                        })
                    })
                    .ToListAsync();

                return Ok(new
                {
                    success = true,
                    data = menus
                });
            }
            catch (Exception ex)
            {
                return StatusCode(500, new { error = ex.Message });
            }
        }

        // ВЫБРАТЬ меню пользователем
        [HttpPost("{menuId}/select/{userId}")]
        public async Task<ActionResult> SelectMenu(int menuId, int userId)
        {
            try
            {
                // Проверяем, существует ли меню
                var menu = await _context.Menus
                    .Include(m => m.Items)
                    .FirstOrDefaultAsync(m => m.Id == menuId);

                if (menu == null)
                    return NotFound(new { error = "Меню не найдено" });

                // Проверяем, существует ли пользователь
                var user = await _context.Users.FindAsync(userId);
                if (user == null)
                    return NotFound(new { error = "Пользователь не найден" });

                // Создаем копию меню для пользователя (или можно просто сохранить связь)
                var userMenu = new Menu
                {
                    UserId = userId,
                    Name = $"{menu.Name} (Выбрано)",
                    CreatedAt = DateTime.UtcNow
                };

                // Копируем блюда из выбранного меню
                foreach (var item in menu.Items)
                {
                    userMenu.Items.Add(new MenuItem
                    {
                        RecipeId = item.RecipeId,
                        Date = item.Date,
                        MealType = item.MealType
                    });
                }

                await _context.Menus.AddAsync(userMenu);
                await _context.SaveChangesAsync();

                return Ok(new
                {
                    success = true,
                    message = "Меню успешно выбрано",
                    menuId = userMenu.Id
                });
            }
            catch (Exception ex)
            {
                return BadRequest(new { error = ex.Message });
            }
        }

        [HttpGet("user/{userId}/current")]
        public async Task<ActionResult> GetCurrentMenu(int userId)
        {
            try
            {
                var menu = await _context.Menus
                    .Include(m => m.Items)
                        .ThenInclude(i => i.Recipe)
                    .Where(m => m.UserId == userId)
                    .OrderByDescending(m => m.CreatedAt)
                    .FirstOrDefaultAsync();

                if (menu == null)
                    return Ok(new
                    {
                        success = true,
                        data = (object)null,
                        message = "У пользователя нет выбранного меню"
                    });

                return Ok(new
                {
                    success = true,
                    data = new
                    {
                        Id = menu.Id,
                        Name = menu.Name,
                        Items = menu.Items.Select(i => new
                        {
                            RecipeId = i.RecipeId,
                            RecipeTitle = i.Recipe.Title,
                            Date = i.Date.ToString("yyyy-MM-dd"),
                            MealType = i.MealType
                        })
                    }
                });
            }
            catch (Exception ex)
            {
                return StatusCode(500, new { error = ex.Message });
            }
        }
    }
}using Microsoft.AspNetCore.Mvc;
using YP_API.Interfaces;
using YP_API.Models;

namespace YP_API.Controllers
{
    [ApiController]
    [Route("api/[controller]")]
    public class RecipesController : ControllerBase
    {
        private readonly IRecipeRepository _recipeRepository;

        public RecipesController(IRecipeRepository recipeRepository)
        {
            _recipeRepository = recipeRepository;
        }

        [HttpGet]
        public async Task<ActionResult> GetRecipes()
        {
            try
            {
                var recipes = await _recipeRepository.GetAllAsync();

                return Ok(new
                {
                    success = true,
                    data = recipes.Select(r => new {
                        Id = r.Id,
                        Title = r.Title,
                        Description = r.Description,
                        Calories = r.Calories,
                        ImageUrl = r.ImageUrl
                    })
                });
            }
            catch (Exception ex)
            {
                return StatusCode(500, new { error = ex.Message });
            }
        }

        [HttpGet("{id}")]
        public async Task<ActionResult> GetRecipe(int id)
        {
            try
            {
                var recipe = await _recipeRepository.GetByIdAsync(id);

                if (recipe == null)
                    return NotFound(new { error = "  " });

                return Ok(new
                {
                    success = true,
                    data = new
                    {
                        Id = recipe.Id,
                        Title = recipe.Title,
                        Description = recipe.Description,
                        Instructions = recipe.Instructions,
                        Calories = recipe.Calories,
                        ImageUrl = recipe.ImageUrl
                    }
                });
            }
            catch (Exception ex)
            {
                return StatusCode(500, new { error = ex.Message });
            }
        }

        [HttpGet("favorites/{userId}")]
        public async Task<ActionResult> GetFavorites(int userId)
        {
            try
            {
                var favorites = await _recipeRepository.GetUserFavoritesAsync(userId);

                return Ok(new
                {
                    success = true,
                    data = favorites.Select(r => new {
                        Id = r.Id,
                        Title = r.Title,
                        Description = r.Description,
                        Calories = r.Calories,
                        ImageUrl = r.ImageUrl
                    })
                });
            }
            catch (Exception ex)
            {
                return StatusCode(500, new { error = ex.Message });
            }
        }

        [HttpPost("{id}/favorite/{userId}")]
        public async Task<ActionResult> ToggleFavorite(int id, int userId)
        {
            try
            {
                var success = await _recipeRepository.ToggleFavoriteAsync(userId, id);

                return Ok(new
                {
                    success = true,
                    message = success ? "  " : "  "
                });
            }
            catch (Exception ex)
            {
                return BadRequest(new { error = ex.Message });
            }
        }
    }
}﻿using Microsoft.AspNetCore.Mvc;
using Microsoft.EntityFrameworkCore;
using YP_API.Data;
using YP_API.Models;

namespace YP_API.Controllers
{
    [ApiController]
    [Route("api/[controller]")]
    public class ShoppingListController : ControllerBase
    {
        private readonly RecipePlannerContext _context;

        public ShoppingListController(RecipePlannerContext context)
        {
            _context = context;
        }

        // СОЗДАТЬ список покупок из меню
        [HttpPost("generate-from-menu/{menuId}/{userId}")]
        public async Task<ActionResult> GenerateFromMenu(int menuId, int userId)
        {
            try
            {
                // Находим меню с рецептами и их ингредиентами
                var menu = await _context.Menus
                    .Include(m => m.Items)
                        .ThenInclude(i => i.Recipe)
                    .FirstOrDefaultAsync(m => m.Id == menuId && m.UserId == userId);

                if (menu == null)
                    return NotFound(new { error = "Меню не найдено" });

                // Получаем все RecipeId из меню
                var recipeIds = menu.Items.Select(i => i.RecipeId).ToList();

                // Получаем все ингредиенты для этих рецептов
                var recipeIngredients = await _context.RecipeIngredients
                    .Include(ri => ri.Ingredient)
                    .Where(ri => recipeIds.Contains(ri.RecipeId))
                    .ToListAsync();

                // Создаем список покупок
                var shoppingList = new ShoppingList
                {
                    UserId = userId,
                    Name = $"Список для {menu.Name}",
                    CreatedAt = DateTime.UtcNow
                };

                // Группируем ингредиенты
                var ingredientGroups = recipeIngredients
                    .GroupBy(ri => ri.IngredientId)
                    .Select(g => new
                    {
                        Ingredient = g.First().Ingredient,
                        TotalQuantity = g.Sum(ri => ri.Quantity)
                    });

                foreach (var group in ingredientGroups)
                {
                    shoppingList.Items.Add(new ShoppingListItem
                    {
                        Name = group.Ingredient.Name,
                        Quantity = group.TotalQuantity,
                        Unit = group.Ingredient.Unit,
                        IsPurchased = false
                    });
                }

                await _context.ShoppingLists.AddAsync(shoppingList);
                await _context.SaveChangesAsync();

                return Ok(new
                {
                    success = true,
                    message = "Список покупок создан",
                    listId = shoppingList.Id,
                    itemCount = shoppingList.Items.Count
                });
            }
            catch (Exception ex)
            {
                return BadRequest(new { error = ex.Message });
            }
        }

        // ПОЛУЧИТЬ текущий список покупок пользователя
        [HttpGet("user/{userId}/current")]
        public async Task<ActionResult> GetCurrentShoppingList(int userId)
        {
            try
            {
                var list = await _context.ShoppingLists
                    .Include(sl => sl.Items)
                    .Where(sl => sl.UserId == userId && !sl.IsCompleted)
                    .OrderByDescending(sl => sl.CreatedAt)
                    .FirstOrDefaultAsync();

                if (list == null)
                    return Ok(new
                    {
                        success = true,
                        data = (object)null,
                        message = "Нет активных списков покупок"
                    });

                return Ok(new
                {
                    success = true,
                    data = new
                    {
                        Id = list.Id,
                        Name = list.Name,
                        IsCompleted = list.IsCompleted,
                        Items = list.Items.Select(i => new
                        {
                            Id = i.Id,
                            Name = i.Name,
                            Quantity = i.Quantity,
                            Unit = i.Unit,
                            IsPurchased = i.IsPurchased
                        })
                    }
                });
            }
            catch (Exception ex)
            {
                return StatusCode(500, new { error = ex.Message });
            }
        }

        // ОТМЕТИТЬ товар как купленный
        [HttpPut("items/{itemId}/toggle")]
        public async Task<ActionResult> ToggleItemPurchased(int itemId)
        {
            try
            {
                var item = await _context.ShoppingListItems.FindAsync(itemId);
                if (item == null)
                    return NotFound(new { error = "Товар не найден" });

                item.IsPurchased = !item.IsPurchased;
                await _context.SaveChangesAsync();

                return Ok(new
                {
                    success = true,
                    message = item.IsPurchased ? "Товар отмечен как купленный" : "Товар отмечен как некупленный"
                });
            }
            catch (Exception ex)
            {
                return BadRequest(new { error = ex.Message });
            }
        }
    }
}using Microsoft.EntityFrameworkCore;
using YP_API.Models;

namespace YP_API.Data
{
    public class RecipePlannerContext : DbContext
    {
        public RecipePlannerContext(DbContextOptions<RecipePlannerContext> options) : base(options) { }

        public DbSet<User> Users { get; set; }
        public DbSet<Recipe> Recipes { get; set; }
        public DbSet<Ingredient> Ingredients { get; set; }
        public DbSet<RecipeIngredient> RecipeIngredients { get; set; }
        public DbSet<Menu> Menus { get; set; }
        public DbSet<MenuItem> MenuItems { get; set; }
        public DbSet<ShoppingList> ShoppingLists { get; set; }
        public DbSet<ShoppingListItem> ShoppingListItems { get; set; }
        public DbSet<UserFavorite> UserFavorites { get; set; }

        protected override void OnModelCreating(ModelBuilder modelBuilder)
        {
            base.OnModelCreating(modelBuilder);

            //    
            modelBuilder.Entity<User>().ToTable("users");
            modelBuilder.Entity<Recipe>().ToTable("recipes");
            modelBuilder.Entity<Ingredient>().ToTable("ingredients");
            modelBuilder.Entity<RecipeIngredient>().ToTable("recipe_ingredients");
            modelBuilder.Entity<Menu>().ToTable("menus");
            modelBuilder.Entity<MenuItem>().ToTable("menu_items");
            modelBuilder.Entity<ShoppingList>().ToTable("shopping_lists");
            modelBuilder.Entity<ShoppingListItem>().ToTable("shopping_list_items");
            modelBuilder.Entity<UserFavorite>().ToTable("user_favorites");

            modelBuilder.Entity<User>(entity =>
            {
                entity.HasKey(u => u.Id);
                entity.Property(u => u.Username).IsRequired().HasMaxLength(50);
                entity.Property(u => u.Password).IsRequired().HasMaxLength(100);
                entity.Property(u => u.Email).HasMaxLength(100);
                entity.HasIndex(u => u.Username).IsUnique();
            });

            modelBuilder.Entity<Recipe>(entity =>
            {
                entity.HasKey(r => r.Id);
                entity.Property(r => r.Title).IsRequired().HasMaxLength(200);
                entity.Property(r => r.Description).HasMaxLength(1000);
                entity.Property(r => r.Instructions).HasColumnType("text");
                entity.Property(r => r.ImageUrl).HasMaxLength(500);
                entity.Property(r => r.Calories).HasPrecision(10, 2);
            });

            modelBuilder.Entity<Ingredient>(entity =>
            {
                entity.HasKey(i => i.Id);
                entity.Property(i => i.Name).IsRequired().HasMaxLength(100);
                entity.HasIndex(i => i.Name).IsUnique();
            });

            modelBuilder.Entity<UserFavorite>(entity =>
            {
                entity.HasKey(uf => uf.Id);
                entity.HasIndex(uf => new { uf.UserId, uf.RecipeId }).IsUnique();
            });
        }
    }
}﻿using YP_API.Models;

namespace YP_API.Interfaces
{
    public interface IRecipeRepository
    {
        Task<IEnumerable<Recipe>> GetAllAsync();
        Task<Recipe> GetByIdAsync(int id);
        Task<bool> ToggleFavoriteAsync(int userId, int recipeId);
        Task<IEnumerable<Recipe>> GetUserFavoritesAsync(int userId);
    }

    public interface IUserRepository
    {
        Task<User> GetUserByUsernameAsync(string username);
        Task AddAsync(User entity);
        Task<bool> SaveAllAsync();
    }
}﻿namespace YP_API.Models
{
    public class User
    {
        public int Id { get; set; }
        public string Username { get; set; }
        public string Password { get; set; }
        public string Email { get; set; }
    }

    public class Recipe
    {
        public int Id { get; set; }
        public string Title { get; set; }
        public string Description { get; set; }
        public string Instructions { get; set; }
        public decimal Calories { get; set; }
        public string ImageUrl { get; set; } = "";
        public int PrepTime { get; set; }
        public int CookTime { get; set; }
    }

    public class Ingredient
    {
        public int Id { get; set; }
        public string Name { get; set; }
        public string Category { get; set; }
        public string Unit { get; set; }
    }

    public class RecipeIngredient
    {
        public int Id { get; set; }
        public int RecipeId { get; set; }
        public int IngredientId { get; set; }
        public decimal Quantity { get; set; }

        public Recipe Recipe { get; set; }
        public Ingredient Ingredient { get; set; }
    }

    public class Menu
    {
        public int Id { get; set; }
        public int UserId { get; set; }
        public string Name { get; set; }
        public DateTime CreatedAt { get; set; } = DateTime.UtcNow;

        public User User { get; set; }
        public ICollection<MenuItem> Items { get; set; } = new List<MenuItem>();
    }

    public class MenuItem
    {
        public int Id { get; set; }
        public int MenuId { get; set; }
        public int RecipeId { get; set; }
        public DateTime Date { get; set; }
        public string MealType { get; set; }

        public Menu Menu { get; set; }
        public Recipe Recipe { get; set; }
    }

    public class ShoppingList
    {
        public int Id { get; set; }
        public int UserId { get; set; }
        public string Name { get; set; }
        public bool IsCompleted { get; set; }
        public DateTime CreatedAt { get; set; } = DateTime.UtcNow;

        public User User { get; set; }
        public ICollection<ShoppingListItem> Items { get; set; } = new List<ShoppingListItem>();
    }

    public class ShoppingListItem
    {
        public int Id { get; set; }
        public int ShoppingListId { get; set; }
        public string Name { get; set; }
        public decimal Quantity { get; set; }
        public string Unit { get; set; }
        public bool IsPurchased { get; set; }

        public ShoppingList ShoppingList { get; set; }
    }

    public class UserFavorite
    {
        public int Id { get; set; }
        public int UserId { get; set; }
        public int RecipeId { get; set; }
        public DateTime AddedAt { get; set; } = DateTime.UtcNow;

        public User User { get; set; }
        public Recipe Recipe { get; set; }
    }
}// <autogenerated />
using System;
using System.Reflection;
[assembly: global::System.Runtime.Versioning.TargetFrameworkAttribute(".NETCoreApp,Version=v8.0", FrameworkDisplayName = ".NET 8.0")]
//------------------------------------------------------------------------------
// <auto-generated>
//     Этот код создан программой.
//     Исполняемая версия:4.0.30319.42000
//
//     Изменения в этом файле могут привести к неправильной работе и будут потеряны в случае
//     повторной генерации кода.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Reflection;

[assembly: System.Reflection.AssemblyCompanyAttribute("YP_API")]
[assembly: System.Reflection.AssemblyConfigurationAttribute("Debug")]
[assembly: System.Reflection.AssemblyFileVersionAttribute("1.0.0.0")]
[assembly: System.Reflection.AssemblyInformationalVersionAttribute("1.0.0+03d04a1fe4d6b0df0d536aecbe96b132e54444c1")]
[assembly: System.Reflection.AssemblyProductAttribute("YP_API")]
[assembly: System.Reflection.AssemblyTitleAttribute("YP_API")]
[assembly: System.Reflection.AssemblyVersionAttribute("1.0.0.0")]

// Создано классом WriteCodeFragment MSBuild.

// <auto-generated/>
global using global::Microsoft.AspNetCore.Builder;
global using global::Microsoft.AspNetCore.Hosting;
global using global::Microsoft.AspNetCore.Http;
global using global::Microsoft.AspNetCore.Routing;
global using global::Microsoft.Extensions.Configuration;
global using global::Microsoft.Extensions.DependencyInjection;
global using global::Microsoft.Extensions.Hosting;
global using global::Microsoft.Extensions.Logging;
global using global::System;
global using global::System.Collections.Generic;
global using global::System.IO;
global using global::System.Linq;
global using global::System.Net.Http;
global using global::System.Net.Http.Json;
global using global::System.Threading;
global using global::System.Threading.Tasks;
//------------------------------------------------------------------------------
// <auto-generated>
//     Этот код создан программой.
//     Исполняемая версия:4.0.30319.42000
//
//     Изменения в этом файле могут привести к неправильной работе и будут потеряны в случае
//     повторной генерации кода.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Reflection;

[assembly: Microsoft.AspNetCore.Mvc.ApplicationParts.ApplicationPartAttribute("Swashbuckle.AspNetCore.SwaggerGen")]

// Создано классом WriteCodeFragment MSBuild.

﻿using Microsoft.EntityFrameworkCore;
using YP_API.Data;
using YP_API.Interfaces;
using YP_API.Models;

namespace YP_API.Repositories
{
    public class RecipeRepository : IRecipeRepository
    {
        private readonly RecipePlannerContext _context;

        public RecipeRepository(RecipePlannerContext context)
        {
            _context = context;
        }

        public async Task<IEnumerable<Recipe>> GetAllAsync()
        {
            return await _context.Recipes.ToListAsync();
        }

        public async Task<Recipe> GetByIdAsync(int id)
        {
            return await _context.Recipes.FindAsync(id);
        }

        public async Task<bool> ToggleFavoriteAsync(int userId, int recipeId)
        {
            var existing = await _context.UserFavorites
                .FirstOrDefaultAsync(uf => uf.UserId == userId && uf.RecipeId == recipeId);

            if (existing != null)
            {
                _context.UserFavorites.Remove(existing);
            }
            else
            {
                var favorite = new UserFavorite
                {
                    UserId = userId,
                    RecipeId = recipeId,
                    AddedAt = DateTime.UtcNow
                };
                await _context.UserFavorites.AddAsync(favorite);
            }

            return await _context.SaveChangesAsync() > 0;
        }

        public async Task<IEnumerable<Recipe>> GetUserFavoritesAsync(int userId)
        {
            return await _context.UserFavorites
                .Where(uf => uf.UserId == userId)
                .Include(uf => uf.Recipe)
                .Select(uf => uf.Recipe)
                .ToListAsync();
        }
    }
}﻿using Microsoft.EntityFrameworkCore;
using YP_API.Data;
using YP_API.Interfaces;
using YP_API.Models;

namespace YP_API.Repositories
{
    public class UserRepository : IUserRepository
    {
        private readonly RecipePlannerContext _context;

        public UserRepository(RecipePlannerContext context)
        {
            _context = context;
        }

        public async Task<User> GetUserByUsernameAsync(string username)
        {
            return await _context.Users
                .FirstOrDefaultAsync(u => u.Username == username);
        }

        public async Task AddAsync(User entity)
        {
            await _context.Users.AddAsync(entity);
        }

        public async Task<bool> SaveAllAsync()
        {
            return await _context.SaveChangesAsync() > 0;
        }
    }
}using YP_API.Interfaces;
using YP_API.Models;

namespace YP_API.Services
{
    public class AuthService : IAuthService
    {
        private readonly IUserRepository _userRepository;

        public AuthService(IUserRepository userRepository)
        {
            _userRepository = userRepository;
        }

        public async Task<User> Login(string username, string password)
        {
            var user = await _userRepository.GetUserByUsernameAsync(username);

            if (user == null)
                throw new Exception("  ");

            if (user.Password != password)
                throw new Exception(" ");

            return user;
        }

        public async Task<User> Register(string username, string email, string password)
        {
            var existingUser = await _userRepository.GetUserByUsernameAsync(username);
            if (existingUser != null)
                throw new Exception("  ");

            var user = new User
            {
                Username = username,
                Email = email,
                Password = password
            };

            await _userRepository.AddAsync(user);
            await _userRepository.SaveAllAsync();

            return user;
        }
    }

    public interface IAuthService
    {
        Task<User> Login(string username, string password);
        Task<User> Register(string username, string email, string password);
    }
}